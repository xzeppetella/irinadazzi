window.xdgetRepository={xdgets:[],registerXdget:function(a){this.xdgets[a.type]=a},getXdgets:function(){return this.xdgets},getXdgetData:function(a){if(!this.xdgets[a])throw"Wrong xdget type: "+a;return this.xdgets[a]},createNewXdgetBlock:function(a,b,c,d){xdgetData=this.getXdgetData(a);a=xdgetData.blockTag;b&&b.tag&&(a=b.tag);a=$("<"+a+" class='xdget-block xdget-"+xdgetData.type+"' />");var e="r"+Math.round(1E4*Math.random());b||(b=xdgetData.defaultParams);a[xdgetData.jsName]({xdgetId:e,type:xdgetData.type,
name:xdgetData.jsName,label:xdgetData.label,params:b,editorEnabled:c?c.options.editorEnabled:!0,existedXdget:!1,parentXdget:c,jsName:xdgetData.jsName,iconClass:xdgetData.iconClass,selfBlock:xdgetData.selfBlock,selfMeaningful:xdgetData.selfMeaningful,style:d,settings:xdgetData.settings});return a},allowedInsertInto:function(a,b){return 1==this.xdgets[a].allowedParentTypes?!0:-1!=this.xdgets[a].allowedParentTypes.indexOf(b)}};
jQuery.widget("gc.abstractXdget",{contentEl:null,blockerEl:null,uncontrolled:!1,type:null,label:null,parentXdget:null,isRoot:!1,jsName:null,onChange:null,currentElClass:null,currentElId:null,xdgetId:null,style:null,settedStyles:{},oldWidth:0,options:{uncontrolled:!1,xdgetId:null,type:null,name:null,params:{},editorEnabled:!1,existedXdget:!0,parentXdget:null,isRoot:!1,jsName:null,settings:{}},params:{},_create:function(){var a=this;this.element.data("xdget",this);this.jsName=this.options.jsName;this.xdgetId=
this.options.xdgetId;this.contentEl=this.element;this.type=this.options.type;this.isRoot=this.options.isRoot;this.parentXdget=this.options.parentXdget;this.isUncontrolled=this.options.uncontrolled;this.options.params.uncontrolled&&(this.isUncontrolled=this.options.params.uncontrolled);!this.parentXdget&&this.element.parents(".xdget-block")&&(this.parentXdget=this.element.parents(".xdget-block").data("xdget"));this.isRoot&&(window.rootXdget=this);this.build();this.setParams(this.options.params,this.options.existedXdget,
!0);(fixedClass=this.getParam("fixedClass"))&&this.element.addClass(fixedClass);this.getParam("clickLink")&&this.element.addClass("with-link");this.isEditorEnabled()?(this.enableEditor(),a=this,this.element.on("mouseover",function(b){if(!$(this).hasClass("dragged")){if(!a.isEditorEnabled()||window.xdgetRootEditorBlock.xdgetEditorControl("isBlocked"))return!1;window.xdgetDragged?($(this).addClass("hovered-add-sibling"),$(this).addClass("hovered-add-child")):$(this).addClass("hovered");b.preventDefault();
b.stopPropagation()}}),this.element.on("mouseout",function(a){$(this).removeClass("hovered");$(this).removeClass("hovered-add-sibling");$(this).removeClass("hovered-add-child");a.preventDefault();a.stopPropagation()})):this.getParam("clickLink")&&this.element.click(function(){$.gc.abstractXdget.prototype.redirectTo(a.getParam("clickLink"))});this.buildPlaceholders();this.options.style&&this.setStyle(this.options.style)},build:function(){},enableEditor:function(){var a=this;this.element.addClass("editable");
this.isContainer()||this.element.addClass("fadeable");this.element.click(function(b){b.stopPropagation();b.preventDefault();if(!a.isEditorEnabled())return!1;window.xdgetRootEditorBlock.xdgetEditorControl("isBlocked")?window.xdgetRootEditorBlock.xdgetEditorControl("clickedOnOtherXdget",a):a.startEditing(!0)});this.enableDraggable()},addBlockerEl:function(){this.blockerEl=this.element;this.blockerEl=$('<div class="xdget-blocker"></div>');this.blockerEl.appendTo(this.element)},enableDraggable:function(){var a=
this.getLabel(),b=this;this.isDraggable()&&this.element.draggable({appendTo:"body",cancel:!1,helper:function(){return $("<div class='xdget-drag-block'>"+a+"</div>")},start:function(){window.xdgetDragged=!0;window.xdgetDraggedType=b.type;b.element.addClass("xdget-dragged");$(".xdget-root").addClass("drag-mode")},stop:function(){window.xdgetDragged=!1;b.element.removeClass("xdget-dragged");$(".xdget-root").removeClass("drag-mode")}})},startEditing:function(a){window.xdgetRootEditorBlock.xdgetEditorControl("setXdget",
this,a)},finishEditing:function(){},getParam:function(a,b){return"undefined"==typeof this.params[a]||""==this.params[a]?b:"false"==this.params[a]?!1:this.params[a]},getParams:function(){return this.params},getParamsAsObject:function(){return this.params},setParams:function(a,b,c){a.elClass!=this.currentElClass&&(this.currentElClass&&""!=this.currentElClass&&this.contentEl.removeClass(this.currentElClass),this.contentEl.addClass(a.elClass),this.currentElClass=a.elClass);if(a.elId||this.currentElId){var d=
"",d=""!=a.elId?a.elId:"xdget"+this.xdgetId;this.contentEl.attr("id",d);this.currentElId=d}d=this.params.mdWidth;this.params={};for(key in a)this.params[key]=a[key];this.applyParams(b);this.refresh();d!=this.params.mdWidth&&this.parentXdget&&this.parentXdget.refresh();c||this.changed()},refresh:function(){var a=this.getMdWidth();this.isInRow()&&(a&&0<a||a!=this.oldWidth)&&this.setBlockSize(this.element,a,"gc");this.oldWidth=a;this.buildInTitle()},isRow:function(){return!1},isInRow:function(){return this.parentXdget&&
this.parentXdget.isRow()},rebuild:function(){this.refresh();this.changed()},applyParams:function(a){},recalcSize:function(){},isDroppable:function(){return!1},isDraggable:function(){return!this.isRootContainer()},getParentXdgetByType:function(a){return this.type==a?this:this.parentXdget?this.parentXdget.getParentXdgetByType(a):null},getXdgetPath:function(){var a=[];this.parentXdget&&(a=this.parentXdget.getXdgetPath());a.push(this);return a},getLabel:function(){return this.options.label},isRootContainer:function(){return!1},
isEditorEnabled:function(){return this.options.editorEnabled},buildInTitle:function(){if(this.isEditorEnabled()&&!this.element.data("disable-in-title")){this.element.find("> .xdget-in-title").detach();var a=this.getLabel();if(elId=this.getParam("elId"))a+=" #"+elId;if(elClass=this.getParam("elClass"))a+=" ."+elClass;if(this.getParam("visibleTo")||this.getParam("invisilbeTo")){var b="\u041d\u0415 \u0412\u0421\u0415\u041c \u041f\u041e\u041a\u0410\u0417\u042b\u0412\u0410\u0415\u0422\u0421\u042f";void 0!==
Yii&&(b=Yii.t("common",b));a+=" -- "+b+" -- "}b=$("<div class='xdget-in-title'/>");b.html(a);b.appendTo(this.element)}},buildPlaceholders:function(){if(!this.isEditorEnabled())return!1;this.element.find("> .xdget-in-placeholder").detach();var a=this,b=[];this.isRootContainer()||(b=["top","bottom","left","right"]);this.isContainer()&&0==this.blocks.length&&b.push("full");if(0==b.length)return!1;for(var c=0;c<b.length;c++){var d=b[c],e=$("<div/>");e.addClass("xdget-in-placeholder");"full"==d?e.addClass("xdget-in-child-placeholder"):
e.addClass("xdget-in-sibling-placeholder");e.addClass("xdget-in-placeholder-"+d);e.appendTo(this.element);e.data("position",d);e.on("mouseover",function(a){window.xdgetDragged&&$(this).addClass("hovered-placeholder")});e.on("mouseout",function(a){window.xdgetDragged&&$(this).removeClass("hovered-placeholder")});e.droppable({tolerance:"pointer",greedy:!0,drop:function(b,c){var d=$(c.draggable);a.droppedBlock(d,$(this).data("position"))}})}},getTargetXdget:function(a,b,c){return this.parentXdget?this.parentXdget.getTargetXdget(a,
!0,this):null},droppedBlock:function(a,b){this.canAddElement();var c=this.parentXdget,d=null;droppedBlockXdgetType=null;a.data("xdget")&&(d=a.data("xdget").parentXdget,droppedBlockXdgetType=a.data("xdget").type);droppedBlockXdgetType||(droppedBlockXdgetType=a.data("xdgetData").type);if("full"!=b||!this.isAllowableChildType(droppedBlockXdgetType)||this.isContainer()&&this.addBlockInside())if("full"==b){targetXdget=this.getTargetXdget(droppedBlockXdgetType,!0);if(!targetXdget)return alert("\u0418\u0437\u0432\u0438\u043d\u0438\u0442\u0435, \u0432 \u044d\u0442\u043e\u0442 \u0431\u043b\u043e\u043a \u043d\u0435\u043b\u044c\u0437\u044f \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442"),
!1;a=targetXdget.processDroppedBlock(a,this,b)}else a=this.parentXdget.processDroppedBlock(a,this,b);else targetXdget=this,a=this.parentXdget.processDroppedBlock(a,this,"bottom");this.rebuild();c&&c!=this&&c.rebuild();d&&d!=c&&d!=this&&d.rebuild();this.parentXdget&&this.parentXdget.rebuild();window.xdgetRootEditorBlock.xdgetEditorControl("blocksChanged");a.data("xdget").startEditing();window.rootXdget.optimize()},optimize:function(){},removeBlockSizeClass:function(a,b){b||(b="md");for(var c=a.get(0).className.split(" "),
d=0;d<c.length;d++){var e=c[d];e.substr(0,7)=="col-"+b+"-"&&a.removeClass(e)}},replaceXdgetWith:function(a){if(!a)return console.error("Try to replace xdget with null"),!1;a.parentXdget=this.parentXdget;this.element.replaceWith(a.element);a.parentXdget&&a.parentXdget.rebuild();this.removeBlockSizeClass(a.element)},destroyXdget:function(a){var b=this.parentXdget;this.element.detach();b&&b.rebuild();window.xdgetRootEditorBlock.xdgetEditorControl("blocksChanged");a&&window.rootXdget.optimize()},getMdWidth:function(){return 1*
this.getParam("mdWidth","m0").replace("m","")},changed:function(){if(this.onChange)this.onChange();this.parentXdget&&this.parentXdget.changed()},getAsObject:function(){var a=this.getParamsAsObject();a.mdWidth=this.params.mdWidth;a={type:this.type,xdgetId:this.options.xdgetId,params:a};this.style&&(a.style=this.style);return a},getChildBlocks:function(){return[]},canAddElement:function(){return!0},isAutoContainer:function(){return!0},isContainer:function(){return!1},getElementTitle:function(){return(value=
this.getParam("elementTitle"))||(value=this.getSetting("elementTitle"))?value:this.getLabel()},setParam:function(a,b){this.options.params[a]=b;this.params[a]=b},setBlockSize:function(a,b,c){c||(c="md");this.removeBlockSizeClass(a,c);a.addClass("col-"+c+"-"+b)},resizeChildren:function(){},canAddSubcontainer:function(){return!0},isAllowableChildType:function(a){a=xdgetRepository.getXdgetData(a);return 1==a.allowedParentTypes?!0:a.allowedParentTypes&&-1!=a.allowedParentTypes.indexOf(this.type)?!0:!1},
isAllowableSiblingType:function(a){if(this.parentXdget)return this.parentXdget.isAllowableChildType(a)},isAllowableAddType:function(a){return this.isAllowableChildType(a)},allowableChildTypes:function(){return null},strictAddTypes:function(){return this.allowableChildTypes()||this.parentXdget&&this.parentXdget.allowableChildTypes()},setStyle:function(a){for(key in this.settedStyles)a[key]||(this.element.css(key,""),this.settedStyles[key]=null);for(key in a){var b=a[key];"background-image"==key&&b&&
(b='url("'+b+'")');this.settedStyles[key]=b;-1<key.indexOf("color")&&b?b="#"+b:this.isNumber(b)&&(b+="px");this.element.css(key,b)}this.style=a},isNumber:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},useChildAvailableChildren:function(){return!1},getOwnAvailableChildren:function(a){a||(a={});return a},getAvailableChildren:function(a,b,c,d){this.getOwnAvailableChildren(a);this.parentXdget&&b&&this.parentXdget.getAvailableChildren(a,!0,!0,this);if(window.savedXdgets)for(b=0;b<window.savedXdgets.length;b++)c=
window.savedXdgets[b],c.group="widgets",c.label=c.params.title,c.type="insertEmbed",c.params.inherited=!0,a["xdget"+c.xdgetId]=c},applyCss:function(){if(this.params.css){var a=$("#css"+this.xdgetId);0<a.length?a.html(this.params.css):(a=$('<style id="css'+this.xdgetId+'">'),a.appendTo($("body")));a.html(this.params.css)}else $("#css"+this.xdgetId).detach()},getSetting:function(a){return this.options.settings?this.options.settings[a]:null},getAvailableCssClasses:function(){var a={};this.fillAvailableClasses(a);
return a},fillAvailableClasses:function(a){a["block-center"]={label:"\u0426\u0435\u043d\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0435\u0441\u044c \u0431\u043b\u043e\u043a"}},addBlockInside:function(){return!1},redirectTo:function(a,b){if(window.appHandleAction&&window.isEnabledChatiumActionInXdget){var c=!0;if(!b)try{var d=window.internalDomains||[],e=(new URL(a)).hostname,c=-1===d.indexOf(e)}catch(f){c=!1}0!==a.indexOf("http")&&0!==a.indexOf("//")&&(a=location.origin+a);window.appHandleAction({type:"navigate",
url:a,openInExternalApp:c})}else b?window.open(a):location.href=a}});
jQuery.widget("gc.xdget_container",$.gc.abstractXdget,{blocks:null,columnNo:null,options:{},build:function(){$.gc.abstractXdget.prototype.build.call(this);this.element.addClass(this.getBlockClass());this.element.addClass("xdget-common-container");!this.options.existedXdget&&this.options.params.children&&this.createChildren()},getBlockClass:function(){return"xdget-col"},applyParams:function(a){this.refresh();this.parentXdget&&this.parentXdget.resizeChildren();this.params.content&&""!=this.params.content?
(a=this.element.find("> .xdget-container-self-content"),this.params.link?($newSelfContent=$("<a class='xdget-container-self-content'>"),$newSelfContent.attr("href",this.params.link)):$newSelfContent=$("<span class='xdget-container-self-content'>"),$newSelfContent.html(this.params.content),0<a.length?a.replaceWith($newSelfContent):$newSelfContent.prependTo(this.element)):this.element.find("> .xdget-container-self-content").detach()},getChildBlocks:function(){return this.contentEl.find("> .xdget-block")},
addNewXdget:function(a){$xdgetBlock=xdgetRepository.createNewXdgetBlock(a.type,a.params,this,a.style);this.appendXdgetBlock($xdgetBlock,null,"full");return $xdgetBlock},appendXdgetBlock:function(a,b,c){this.removeBlockSizeClass(a);a.data("xdget").parentXdget=this;b?"before"==c?a.insertBefore(b.element):a.insertAfter(b.element):a.appendTo(this.contentEl);this.refresh()},createChildren:function(){for(key in this.options.params.children)this.addNewXdget(this.options.params.children[key])},isRootContainer:function(){return this.isRoot},
unwrap:function(){this.blocks=this.getChildBlocks();for(var a=this,b=0;b<this.blocks.length;b++){var c=$(this.blocks[b]);this.parentXdget.appendXdgetBlock(c,a,"bottom");a=c.data("xdget");c.data("xdget").optimize()}this.destroyXdget();this.blocks=[]},optimize:function(){this.blocks=this.getChildBlocks();for(var a=0;a<this.blocks.length;a++)$(this.blocks[a]).data("xdget").optimize();"row"==this.type&&1==this.blocks.length&&this.unwrap();"container"==this.type&&"row"!=this.parentXdget.type&&this.unwrap();
this.isAutoContainer()&&0==this.blocks.length&&this.destroyXdget()},rebuild:function(){if(window.xdgetNoRebuild)return!1;this.blocks=this.getChildBlocks();this.refresh();this.isContainer()&&this.buildPlaceholders();0<this.blocks.length&&this.element.find("> .xdget-in-placeholder-full").detach();this.parentXdget&&this.parentXdget.rebuild();this.changed()},refresh:function(){$.gc.abstractXdget.prototype.refresh.call(this);this.blocks=this.getChildBlocks();0==this.blocks.length?this.element.addClass("empty"):
this.element.removeClass("empty");this.resizeChildren()},resizeChildren:function(){},getBlocksCount:function(){return this.blocks.length},isDroppable:function(){return!0},wrapDraggedBlock:function(a){$result=a;$result.hasClass("new-xdget")&&(a=a.data("xdgetData"),$result=xdgetRepository.createNewXdgetBlock(a.type,a.params,this));return $result},processDroppedBlock:function(a,b,c){a=this.wrapDraggedBlock(a);switch(c){case "full":this.isAutoContainer()?this.appendXdgetBlock(a):this.appendXdgetBlock(a,
null,"after");break;case "top":this.appendXdgetBlock(a,b,"before");break;case "bottom":this.appendXdgetBlock(a,b,"after");break;case "left":this.makeSubcontainer(a,b,"before");break;case "right":this.makeSubcontainer(a,b,"after")}this.refresh();return a},getSubcontainerType:function(){return"row"},makeSubcontainer:function(a,b,c){if(this.canAddSubcontainer())$subcontainer=xdgetRepository.createNewXdgetBlock(this.getSubcontainerType(),{},this),$subcontainerXdget=$subcontainer.data("xdget"),$subcontainer.insertBefore(b.element),
window.xdgetNoRebuild=!0,$subcontainerXdget.appendXdgetBlock(b.element),$subcontainerXdget.appendXdgetBlock(a,b,c),window.xdgetNoRebuild=!1;else return this.appendXdgetBlock(a,b,c)},getLabel:function(){return this.isRootContainer()?Yii.t("common","\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430"):this.columnNo?Yii.t("common","\u043a\u043e\u043b\u043e\u043d\u043a\u0430")+" "+this.columnNo+"":Yii.t("common","\u041a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440")},getParamsAsObject:function(){var a=
$.gc.abstractXdget.prototype.getParamsAsObject.call(this);a.children=[];if(!this.getParam("inherited")){this.blocks=this.getChildBlocks();for(var b=0;b<this.blocks.length;b++){var c=$(this.blocks[b]).data("xdget");c&&a.children.push(c.getAsObject())}}return a},isAutoContainer:function(){return"undefined"!=typeof this.getSetting("isAutoContainer")?this.getSetting("isAutoContainer"):!this.isRootContainer()},isContainer:function(){return!0},getAvailableChildren:function(a,b,c,d){$.gc.abstractXdget.prototype.getAvailableChildren.call(this,
a,b,c);c&&this.useChildAvailableChildren()&&this.getChildBlocks().each(function(b,c){var g=$(c).data("xdget");g&&g!=d&&g.getAvailableChildren(a,!1,!0)})},getTargetXdget:function(a,b,c){if(this.isAllowableChildType(a))return this;var d=null;this.getChildBlocks().each(function(b,f){var g=$(f).data("xdget");if(g&&g.isContainer()&&g!=c&&(result=g.getTargetXdget(a,!1)))return d=result,!1});return d?d:b&&this.parentXdget?this.parentXdget.getTargetXdget(a,!0,this):null},addBlockInside:function(){return!0}});
window.Yii||(window.Yii={t:function(a,b){return b}});jQuery.widget("gc.xdget_form",$.gc.xdget_container,{getBlockClass:function(){return"form"},getLabel:function(){return Yii.t("common","\u0424\u043e\u0440\u043c\u0430")},isAutoContainer:function(){return!1}});
jQuery.widget("gc.xdget_formField",$.gc.abstractXdget,{fieldWidget:null,applyParams:function(){this.element.addClass("xdget-form-field-"+this.getParam("fieldName"));null==this.fieldWidget&&this.params.fieldType&&this.params.fieldOptions&&(this.element.empty(),$el=$("<div class='form-field form-field-"+this.getFieldName()+"'/>"),this.params.fieldOptions.settings||(this.params.fieldOptions.settings={}),window.gcCreateFieldWidget($el,this.params.fieldType,{field:this.params.fieldOptions,hideShowInTableInput:!0}),
this.fieldWidget=$el.data("fieldWidget"),$el.appendTo(this.element),this.element.find("input,textarea").addClass("form-control"),this.element.find("input,textarea").addClass("form-field-"+this.getFieldName()),this.element.find("input,textarea").attr("name",this.getFieldName()))},build:function(){this.element.addClass("xdget-formField")},getElementTitle:function(){return this.fieldWidget&&this.fieldWidget.field.label&&""!=this.fieldWidget.field.label?this.fieldWidget.field.label:this.getParam("fieldName")},
getFieldName:function(){return this.getParam("fieldName")},getFieldValue:function(){return this.fieldWidget.getValue()},validate:function(){var a=this.getFieldValue();if(this.params.fieldOptions.required&&"false"!=this.params.fieldOptions.required&&!a)return this.element.addClass("has-error"),!1;this.element.removeClass("has-error");return!0},getFieldLabel:function(){var a=this.getParam("fieldOptions").label;return a?a:this.getDefaultLabel()},getDefaultLabel:function(){var a=this.getParam("fieldName");
emailValue="E-Mail";nameValue="\u0412\u0430\u0448\u0435 \u0438\u043c\u044f";firstNameValue="\u0418\u043c\u044f";lastNameValue="\u0424\u0430\u043c\u0438\u043b\u0438\u044f";phoneValue="\u0422\u0435\u043b\u0435\u0444\u043e\u043d";phoneVerifyValue="\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430";birthdayValue="\u0414\u0430\u0442\u0430 \u0440\u043e\u0436\u0434\u0435\u043d\u0438\u044f";avatarValue="\u0410\u0432\u0430\u0442\u0430\u0440";
passwordValue="\u041f\u0430\u0440\u043e\u043b\u044c";cityValue="\u0413\u043e\u0440\u043e\u0434";"undefined"!=typeof Yii&&(emailValue=Yii.t("common","E-Mail"),nameValue=Yii.t("common","Your name"),firstNameValue=Yii.t("common","Name"),lastNameValue=Yii.t("common","Surname"),phoneValue=Yii.t("common","Phone"),phoneVerifyValue=Yii.t("common","Verify your phone"),birthdayValue=Yii.t("common","Birthday"),avatarValue=Yii.t("common","Avatar"),passwordValue=Yii.t("common","Password"),cityValue=Yii.t("common",
"City"));switch(a){case "email":return emailValue;case "full_name":case "name":return nameValue;case "first_name":return firstNameValue;case "last_name":return lastNameValue;case "phone":return phoneValue;case "phoneConfirm":return phoneVerifyValue;case "birthday":return birthdayValue;case "profile_image":return avatarValue;case "password":return passwordValue;case "city":return cityValue;default:return a}},_setValue:function(a,b){this.element.find("input").val(a);"file"==this.getParam("fieldType")&&
this.element.find(".form-field").data("fieldWidget").valueChanged(!0);"phone_confirm"==this.getParam("fieldType")&&this.element.find(".form-field").data("fieldWidget").valueChanged(a,b);a&&""!=a&&("email"==this.getParam("fieldName")&&this.element.find("input").attr("disabled","disabled"),this.params.fieldOptions.hide_filled&&"false"!=this.params.fieldOptions.hide_filled&&("phone_confirm_code"==this.params.fieldName?-1==a&&this.element.hide():this.element.hide()))}});
jQuery.widget("gc.xdget_substitution",$.gc.xdget_container,{options:{},build:function(){if(!this.isEditorEnabled()){var a=this;if(this.options.settings){var b=[];this.options.settings.setupUrl&&(e=$('<button class="btn global-edit-btn "><span class="fa fa-puzzle-piece"></span> '+Yii.t("common","Customize view")+"</button>"),e.click(function(){$.gc.abstractXdget.prototype.redirectTo(a.options.settings.setupUrl)}),b.push(e));if(this.options.settings.buttons)for(var c=0;c<this.options.settings.buttons.length;c++){var d=
this.options.settings.buttons[c],e=$('<button class="btn '+d["class"]+' global-edit-btn ">'+(d.icon?"<span class='"+d.icon+"'></span> ":"")+d.label+"</button>");e.data("url",d.url);e.data("newWindow",d.newWindow);d.confirm&&e.data("confirm-text",d.confirm);e.appendTo($("body"));d.customHandler||e.click(function(){if(!$(this).data("confirm-text")||confirm($(this).data("confirm-text"))){var a=$(this).data("url");$(this).data("newWindow")?$.gc.abstractXdget.prototype.redirectTo(a,!0):$.gc.abstractXdget.prototype.redirectTo(a)}});
b.push(e)}if(0<b.length)for(d=$(".inline-global-controls"),0==d.length&&(d=$('<div class="global-controls"></div>'),d.appendTo($("body"))),c=0;c<b.length;c++){var e=b[c];e.appendTo(d)}}}},applyParams:function(a){},getChildBlocks:function(){return this.contentEl.find(".xdget-area")},getLabel:function(){return"\u0428\u0430\u0431\u043b\u043e\u043d"},canAddElement:function(){return!1}});
jQuery.widget("gc.xdget_tag",$.gc.abstractXdget,{build:function(){},applyParams:function(a){a||(a=this.getParam("content"),this.contentEl.html(a),this.isEditorEnabled()&&this.buildPlaceholders())},getElementTitle:function(){var a=$.gc.abstractXdget.prototype.getElementTitle.call(this),b=this.getParam("content",a);return""==b?a:b},getTag:function(){return this.options.params.tag?this.options.params.tag:"span"}});
jQuery.widget("gc.xdget_list",$.gc.xdget_container,{getBlockClass:function(){return"list"},getLabel:function(){return Yii.t("common","\u0421\u043f\u0438\u0441\u043e\u043a")},isAutoContainer:function(){return!1},canAddSubcontainer:function(){return!1},allowableChildTypes:function(){return["item"]},useChildAvailableChildren:function(){return!0}});
jQuery.widget("gc.xdget_area",$.gc.xdget_container,{canBeInherited:!1,descriptionLabel:!1,options:{},build:function(){$.gc.xdget_container.prototype.build.call(this);this.options.editorEnabled&&this.addBlockerEl();this.options.params.canBeInherited&&(this.canBeInherited=!0)},applyParams:function(a){$.gc.xdget_container.prototype.applyParams.call(this,a);this.options.editorEnabled&&this.getParam("inherited")?this.element.addClass("blocked"):this.element.hasClass("blocked")&&this.element.removeClass("blocked")},
getLabel:function(){return Yii.t("common","\u041e\u0431\u043b\u0430\u0441\u0442\u044c: ")+this.getParam("areaName")},isRootContainer:function(){return!0},getParamsAsObject:function(){var a=$.gc.xdget_container.prototype.getParamsAsObject.call(this);a.areaName=this.getParam("areaName");a.inherited=this.getParam("inherited")?1:0;a.autoCreated=this.getParam("autoCreated");return a},refresh:function(){$.gc.xdget_container.prototype.refresh.call(this);this.isEditorEnabled()&&(this.element.hasClass("empty")?
this.descriptionLabel||(this.descriptionLabel=$("<div>\u041e\u0431\u043b\u0430\u0441\u0442\u044c "+this.getParam("areaName")+"</div>"),this.descriptionLabel.appendTo(this.element)):this.descriptionLabel&&(this.descriptionLabel.detach(),this.descriptionLabel=null))},getOwnAvailableChildren:function(a){$.gc.xdget_container.prototype.getOwnAvailableChildren.call(this,a);var b=[{type:"div",params:{elClass:"container"}}],c=[{type:"div",params:{elClass:"container",children:[{type:"row",params:{children:[{type:"div",
params:{elClass:"overview",children:[{type:"header",params:{content:Yii.t("common","\u041e\u0442\u043b\u0438\u0447\u043d\u044b\u0439 \u043b\u0435\u043d\u0434\u0438\u043d\u0433 \u0434\u043b\u044f \u043c\u043e\u0435\u0433\u043e \u043f\u0440\u043e\u0435\u043a\u0442\u0430")}},{type:"html",params:{elClass:"summary",content:"<ul><li>\u041d\u0430\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0435\u043c\u044b\u0439 \u0434\u0438\u0437\u0430\u0439\u043d</li><li>\u0413\u0438\u0431\u043a\u0430\u044f \u0432\u0435\u0440\u0441\u0442\u043a\u0430</li><li>\u0412\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 \u0441\u0431\u043e\u0440 \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u043e\u0432</li><li>\u0412\u0441\u0442\u0430\u0432\u043a\u0430 \u0432\u0438\u0434\u0435\u043e</li></ul>"}}]}},
{type:"div",params:{children:[{type:"video",params:{type:"vimeo",videoId:101321156,playerWidth:500,playerHeight:280}}]}}]}}]}}];a.sectionEmpty={group:"section",iconClass:"fa fa-square-o",type:"section",label:Yii.t("common","\u041f\u0443\u0441\u0442\u0430\u044f \u0441\u0435\u043a\u0446\u0438\u044f"),params:{children:b}};a.sectionPattern={group:"section",iconClass:"fa fa-square",type:"section",label:Yii.t("common","\u0421\u0435\u043a\u0446\u0438\u044f \u0441 \u0444\u043e\u043d\u043e\u043c"),params:{elClass:"has-pattern",
children:b}};a.sectionPromo={group:"section",iconClass:"fa fa-certificate",type:"section",label:Yii.t("common","\u041f\u0440\u043e\u043c\u043e \u0441 \u0432\u0438\u0434\u0435\u043e"),params:{elClass:"promo",children:c}};return a},hasOwnAvailableChildren:function(){return!0}});
jQuery.widget("gc.xdget_button",$.gc.xdget_tag,{applyParams:function(a){$.gc.xdget_tag.prototype.applyParams.call(this,a);if(!this.isEditorEnabled()){var b=this.getParam("onClick");b&&this.element.click(function(){eval(b)})}},getTag:function(){return"button"},fillAvailableClasses:function(a){$.gc.xdget_tag.prototype.fillAvailableClasses.call(this,a);classes["btn-block"]={label:"\u041a\u043d\u043e\u043f\u043a\u0430 \u043d\u0430 \u0432\u0441\u044e \u0448\u0438\u0440\u0438\u043d\u0443 \u0431\u043b\u043e\u043a\u0430"};
classes["btn-success"]={label:"\u041a\u043d\u043e\u043f\u043a\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u0433\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f (\u0437\u0435\u043b\u0435\u043d\u0430\u044f)"};classes["btn-primary"]={label:"\u041a\u043d\u043e\u043f\u043a\u0430 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0433\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f (\u0441\u0438\u043d\u044f\u044f)"};classes["btn-warning"]={label:"\u041a\u043d\u043e\u043f\u043a\u0430 \u043f\u0440\u0435\u0434\u0443\u043f\u0440\u0435\u0436\u0434\u0435\u043d\u0438\u044f (\u0436\u0435\u043b\u0442\u0430\u044f)"};
classes["btn-danger"]={label:"\u041a\u043d\u043e\u043f\u043a\u0430 \u0432\u0430\u0436\u043d\u043e\u0433\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f (\u043a\u0440\u0430\u0441\u043d\u0430\u044f)"}}});
jQuery.widget("gc.xdget_chooseVariant",$.gc.xdget_container,{selector:null,resizeStarted:!1,selectedBlock:null,getLabel:function(){return Yii.t("common","\u0412\u044b\u0431\u043e\u0440 \u0438\u0437 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432")},isAutoContainer:function(){return!1},applyParams:function(a){},createVariantSelector:function(){this.selector&&(this.selector.detach(),this.selector=null);var a=this;this.selector=$selector=$("<ul class='xdget-choose-variant-selector'>");this.selector.prependTo(this.element);
for(var b=0,c=this.getChildBlocks(),d=0;d<c.length;d++){var e=$(c[d]);e.addClass("hidden-variant");var f=e.data("xdget");b++;$option=$('<li class="variant-link"/>');$option.addClass("option-"+f.xdgetId);$option.data("block",e);$option.html(f.getElementTitle());$option.appendTo($selector);$option.click(function(b){var c=a.selectVariant($(this).data("block"));c&&c.startEditing();b.stopPropagation();b.preventDefault()})}this.selectedBlock?this.selectVariant(this.selectedBlock):0<c.length&&this.selectVariant($(c[0]));
return $selector},selectVariant:function(a){var b=a.data("xdget"),c=b.xdgetId;this.getChildBlocks().addClass("hidden-variant");this.selector.find(".variant-link").removeClass("active");this.selector.find(".option-"+c).addClass("active");a.removeClass("hidden-variant");this.selectedBlock=a;return b},resizeChildren:function(){var a=this;this.isEditorEnabled()&&!this.resizeStarted&&(setTimeout(function(){a.createVariantSelector();a.resizeStarted=!1},100),this.resizeStarted=!0)}});
$(function(){var a=(new Date).getTime();setInterval(function(){3E3<Math.abs((new Date).getTime()-a)&&$.countdown.resync();a=(new Date).getTime()},3E3)});
jQuery.widget("gc.xdget_countdown",$.gc.abstractXdget,{applyParams:function(a){this.countdownEl&&this.countdownEl.detach();finishDate=this.getParam("finishDate");this.addText=$("<div>");this.addText.addClass("countdown-text");this.addText.appendTo(this.element);this.countdownEl=$("<div>");this.countdownEl.addClass("countdown-timer");this.countdownEl.appendTo(this.element);if(finishDate){a=finishDate.split(/[^0-9]/);"en"==window.language&&$.countdown.setDefaults($.countdown.regionalOptions[""]);a=
2E3<a[2]?new Date(a[2],a[1]-1,a[0],a[3],a[4],a[5]|0):new Date(a[0],a[1]-1,a[2],a[3],a[4],a[5]|0);var b=window.nowTime,c="HMS";3<(a-b)/864E5&&(c="D HMS");if(a<=b)return"dealCountdown"===this.type&&this.getParam("textOnFinish")&&(this.element.addClass("with-border"),this.element.addClass("time-over"),this.addText.html(this.getParam("textOnFinish"))),"promoCountdown"===this.type&&this.getParam("textOnFinish")&&(this.addText.addClass("is-countdown"),this.addText.html(this.getParam("textOnFinish"))),!1;
if(b=this.getParam("countdownText"))this.element.addClass("with-border"),this.addText.html(b);this.countdownEl.countdown({until:a,padZeroes:!0,compact:!0,format:c,timezone:void 0!==window.dateOffset?60*window.dateOffset:180,expiryText:this.getParam("textOnFinish"),expiryUrl:this.getParam("expiryUrl"),serverSync:function(){var a;$.ajax("/sales/shop/syncTime",{async:!1,success:function(b){a=new Date(b)},error:function(){a=new Date},dataType:"text"});return a}})}else"dealCountdown"!=this.type&&this.countdownEl.html(Yii.t("common",
"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0434\u0430\u0442\u0443 \u0432 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u0445"))}});jQuery.widget("gc.xdget_div",$.gc.xdget_container,{getBlockClass:function(){return"div"},getLabel:function(){return this.getSetting("label")?this.getSetting("label"):Yii.t("common","\u041a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440")},isAutoContainer:function(){return!1}});
jQuery.widget("gc.xdget_dynamicContainer",$.gc.xdget_container,{oldAdditionalClass:null,build:function(){$.gc.xdget_container.prototype.build.call(this);var a="xdgetRefresh"+this.xdgetId,b=this;window.accountUserWebSocketConnection&&window.accountUserWebSocketConnection.subscribeChannel(a,function(a,d){b.applyDynamicParams(d)});b.applyDynamicParams(this.options.params)},getBlockClass:function(){return"dynamic-container"},getLabel:function(){return this.getSetting("label")?this.getSetting("label"):
"\u0414\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440"},isAutoContainer:function(){return!1},applyDynamicParams:function(a){this.oldAdditionalClass&&this.oldAdditionalClass!=a.additional_class&&this.element.removeClass(this.oldAdditionalClass);a.additional_class!=this.oldAdditionalClass&&this.element.addClass(a.additional_class);this.isEditorEnabled()||(a.need_hide?this.element.addClass("hidden"):this.element.removeClass("hidden"));
a.additional_class&&(this.oldAdditionalClass=a.additional_class)}});
jQuery.widget("gc.xdget_statefull",$.gc.xdget_container,{selector:null,selectorInited:!1,applyParams:function(a){this.isEditorEnabled()&&this.createStateSelector();this.element.find(".state-block").hide();this.getParam("state")&&this.element.find(".state-block.state-"+this.getParam("state")).show()},getBlockClass:function(){return"statefull"},getLabel:function(){return this.getSetting("label")},isAutoContainer:function(){return!1},getState:function(){return this.getParam("state")},changeState:function(a){this.setParam("state",
a);this.applyParams(!1)},createStateSelector:function(){if(this.selectorInited)return!1;this.selector&&(this.selector.detach(),this.selector=null);var a=this;this.selector=$selector=$("<ul class='xdget-choose-state-selector'>");this.selector.prependTo(this.element);var b=this.getSetting("states"),c=this.getState(),d;for(d in b){var e=b[d];$option=$('<li class="state-link"/>');$option.data("state",d);$option.html(e);$option.appendTo($selector);c==d&&$option.addClass("active");$option.click(function(b){a.selector.find(".state-link").removeClass("active");
$(this).addClass("active");var c=$(this).data("state");a.changeState(c);b.preventDefault();b.stopPropagation()})}this.selectorInited=!0;return $selector}});
jQuery.widget("gc.xdget_fileList",$.gc.abstractXdget,{fileListEl:null,applyParams:function(a){var b=this,c=this.getParam("fileList",{files:[]}),d=this.fileListEl=$("<ul/>");d.addClass(this.getFileListClass());this.isEditorEnabled()&&(0==c.files.length&&d.html("<center>"+Yii.t("common","\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0444\u0430\u0439\u043b\u044b \u0432 \u043c\u0435\u043d\u044e \u0441\u043f\u0440\u0430\u0432\u0430 \u0438\u043b\u0438 \u0449\u0435\u043b\u043a\u043d\u0438\u0442\u0435 \u0434\u0432\u0430 \u0440\u0430\u0437\u0430 \u0434\u043b\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438")+"</center>"),
a&&this.element.dblclick(function(){b.startEditing();window.xdgetRootEditorBlock.xdgetEditorControl("getEditor").editFileList()}));d.addClass("file-list");for(key in c.files)a=gcGetFileObj(c.files[key]),$fileEl=$("<li/>"),this.fillFileEl($fileEl,a,key),$fileEl.appendTo(d);c=this.element.find(".file-list-content");0==c.length&&(c=$("<div class='file-list-content'/>"),c.appendTo(this.element));c.empty();d.appendTo(c)},fillFileEl:function(a,b,c){a.addClass("file-item");this.getParam("showTitle")&&($titleEl=
$("<a target='_blank' href='"+b.getDownloadUrl()+"'class='title' data-index='"+c+"'>"+b.title+"</a>"),$titleEl.appendTo(a));this.getParam("showDescription")&&b.description&&($descriptionEl=$("<span class='description'>"+b.description+"</span>"),$descriptionEl.appendTo(a));$thumbnailLink=$("<a class='thumbnail-link'/>");$thumbnailLink.attr("href",getThumbnailUrl(b.hash,900,""));$thumbnailLink.attr("title",b.title);$thumbnailEl=$("<img/>");$thumbnailEl.addClass("thumbnail");$thumbnailEl.attr("src",
getThumbnailUrl(b.hash,this.getThumbnailSize(),this.getThumbnailSize()));$thumbnailEl.appendTo($thumbnailLink);$thumbnailLink.prependTo(a)},getThumbnailSize:function(){return 40},getFileListClass:function(){return"standard-file-list"}});
jQuery.widget("gc.xdget_gallery",$.gc.xdget_fileList,{globalGalleryEl:null,localGalleryEl:null,getThumbnailSize:function(){switch(this.getParam("previewSize")){case "xtrasmall":return 50;case "small":return 137;case "medium":return 220;case "big":return 300;case "xtrabig":return 500;default:return 220}},applyParams:function(a){$.gc.xdget_fileList.prototype.applyParams.call(this,a);"carousel"==this.getParam("viewMode")?(a=this.getLocalGalleryEl(),blueimp.Gallery(this.fileListEl.find("a.thumbnail-link"),
{container:a,carousel:!0})):(this.getGlobalGalleryEl(),this.localGalleryEl&&(this.localGalleryEl.detach(),this.localGalleryEl=null),this.isEditorEnabled()||this.fileListEl.find("a").click(function(a){$links=$(this).parents(".file-list").find("a.thumbnail-link");a={index:this};$(this).data("index")&&(a.index=$(this).data("index"));a.transitionSpeed=200;a.displayTransition=!1;blueimp.Gallery($links,a);return!1}))},getGlobalGalleryEl:function(){null==this.globalGalleryEl&&($galleryEl=$("#blueimp-gallery"),
0==$galleryEl.length&&($galleryEl=$('<div id="blueimp-gallery" class="blueimp-gallery blueimp-gallery-controls"><div class="slides next-click"></div><h3 class="title"></h3><a class="prev">\u2039</a><a class="next next-click">\u203a</a><a class="play-pause"></a><ol class="indicator"></ol></div>')),$galleryEl.appendTo($("body")),this.globalGalleryEl=$galleryEl);return this.globalGalleryEl},getLocalGalleryEl:function(){null==this.localGalleryEl&&($galleryEl=$('<div id="blueimp-gallery-carousel" class="blueimp-gallery blueimp-gallery-carousel blueimp-gallery-controls"><div class="slides"></div><h3 class="title"></h3><a class="prev">\u2039</a><a class="next">\u203a</a><a class="play-pause"></a><ol class="indicator"></ol></div>'),
$galleryEl.appendTo(this.element),this.localGalleryEl=$galleryEl);return this.localGalleryEl},getFileListClass:function(){var a="";switch(this.getParam("viewMode")){case "tile":a="gallery-tile";break;case "carousel":a="gallery-carousel";break;default:a="gallery-list"}this.getParam("thumbnailBorder")||(a+=" no-thumbnail-border");return a}});jQuery.widget("gc.xdget_header",$.gc.xdget_tag,{getTag:function(){return this.params.size&&""!=this.params.size?this.params.size:"h2"}});
jQuery.widget("gc.xdget_html",$.gc.abstractXdget,{options:{},build:function(){this.htmlContentEl=this.element.find("> .html-content");0==this.htmlContentEl.length?(this.htmlContentEl=$("<div class='html-content'></div>"),this.htmlContentEl.prependTo(this.element)):this.setParam("content",this.htmlContentEl.html())},applyParams:function(a){a||this.htmlContentEl.html(this.params.content)},getElementTitle:function(){var a=$.gc.abstractXdget.prototype.getElementTitle.call(this),b=this.getParam("content",
a),b=b.replace(/(<([^>]+)>)/ig,""),b=b.replace(/\n/ig,""),b=b.trim();return 2>b.length?a:b.substr(0,30)+"..."}});
jQuery.widget("gc.xdget_image",$.gc.abstractXdget,{url:null,img:null,description:null,applyParams:function(a){var b=this;a&&this.element.click(function(a){b.onClick(a)});a=this.getParam("filehash");if(!a&&this.isEditorEnabled())return this.element.html(Yii.t("common","\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0444\u0430\u0439\u043b")),!1;var c=this.getParam("width",""),d=this.getParam("height","");this.isNumber(c)||(c="");this.isNumber(d)||(d="");var e="";""!=c||""!=d?e=getThumbnailUrl(a,
c,d):(c=a?a.split("."):[],e=1<c.length&&"heic"===c.pop()?getThumbnailUrl(a,200,""):getDownloadUrl(a));this.getParam("useAsBackground")?(this.img&&(this.img.detach(),this.img=null),this.element.css("background-image","url('"+e+"')"),this.element.css("background-size",this.getParam("backgroundSize"))):(this.element.css("background-image",""),e==this.url&&this.img||(this.img||(this.element.empty(),this.img=$("<img>"),this.img.prependTo(this.element)),this.img.attr("src",e),this.url=e),this.getParam("alt")&&
this.img&&(this.img.attr("alt",this.getParam("alt")),this.img.attr("title",this.getParam("alt"))),this.getParam("description")?(this.description||(this.description=$("<span class='image-desc'>"),this.description.insertAfter(this.img)),this.description.html(this.getParam("description"))):this.description&&this.description.detach(),this.getParam("link")?this.element.addClass("with-link"):this.element.removeClass("with-link"),this.getParam("widthFit")?this.element.addClass("width-fit"):this.element.removeClass("width-fit"))},
onClick:function(a){this.isEditorEnabled()||this.getParam("link")&&(2==a.which||this.getParam("link_new_window")?$.gc.abstractXdget.prototype.redirectTo(this.getParam("link"),!0):1==a.which&&$.gc.abstractXdget.prototype.redirectTo(this.getParam("link")))}});jQuery.widget("gc.xdget_item",$.gc.xdget_container,{getTag:function(){return"li"},isAutoContainer:function(){return!1},canAddSubcontainer:function(){return!1},allowableChildTypes:function(){return["list"]}});
jQuery.widget("gc.xdget_javascript",$.gc.abstractXdget,{options:{},build:function(){},applyParams:function(a){this.isEditorEnabled()&&this.element.html(this.getElementTitle())},getElementTitle:function(){return this.getParam("scriptName","javascript")}});
jQuery.widget("gc.xdget_userForm",$.gc.xdget_form,{selector:null,clickedButton:null,loginBlock:null,previousState:null,messageEl:null,remindMode:!1,action:"form",applyParams:function(a){this.element.addClass("xdget-common-user-form");var b=this;a&&(this.isEditorEnabled()||(b.trySendCallback=addGlobalCheckbox(this.element),this.element.submit(function(a){if(this.remindMode)return!1;b.trySendData();return!1}),this.element.find("button").click(function(){b.setClickedButton(this)}),this.element.find(".btn-register").click(function(){console.log(1111);
b.changeState("register");return!1}),$(".btn-login",this.element).click(function(){b.changeState("login");return!1}),$(".btn-remind",this.element).click(function(){b.showRemindForm();return!1}),$(".btn-enter",this.element).click(function(){if(b.getParam("open_new_window"))return window.top.location.href="/",!1;$.gc.abstractXdget.prototype.redirectTo("/");return!1}),$(".btn-logout",this.element).click(function(){b.trySendData({action:"logout"});return!1}),this.loginBlock=this.createLoginBlock(),this.loginBlock.appendTo(this.element),
this.loginBlock.hide(),this.remindBlock=this.createRemindBlock(),this.remindBlock.appendTo(this.element),this.remindBlock.hide(),$(document).ready(function(){b.element.find(".btn-register").get(0)&&"#registration"==window.location.hash&&b.changeState("register")})),this.isEditorEnabled()||(setTimeout(function(){var a=!1;$(".xdget-userFormField").each(function(){$xdgetBlock=$(this);if(xdget=$xdgetBlock.data("xdget")){var d=xdget.getParam("fieldName"),d=b.params.default_values[d];xdget._setValue(d,
b.params.default_values);!b.getParam("showOnlyOneField")||d&&""!=d||(a?$xdgetBlock.hide():a=!0)}})},100),this.getParam("run_try_process")&&setTimeout(function(){b.trySendData()},100)),this.messageEl=$('<div class="alert alert-danger error-message">'),this.messageEl.appendTo(this.element),this.messageEl.hide());this.isEditorEnabled()&&!this.selector&&this.createStateSelector();this.getParam("state")&&(this.previousState&&this.element.removeClass("state-"+this.previousState),a=this.getParam("state"),
this.element.addClass("state-"+a),this.element.find(".state-form").removeClass("active-state"),this.element.find("."+a+"-form").addClass("active-state"),this.previousState=a);this.element.trigger("xdgetApplyParams")},setClickedButton:function(a){this.clickedButton=$(a);var b=this;setTimeout(function(){b.clickedButton=null},300)},changeState:function(a){this.setParam("state",a);this.applyParams(!1)},showLoginForm:function(a){this.element.addClass("hide-content");a&&this.loginBlock.setEmail(a);this.loginBlock.show();
this.loginBlock.passwordInput.focus();this.action="auth"},showRemindForm:function(){this.remindMode=!0;this.remindBlock.show();this.element.addClass("hide-content");this.action="auth"},showMainForm:function(){this.remindMode=!1;"after_send"==this.getState()&&this.changeState("before_send");this.action="form";this.element.removeClass("hide-content");this.loginBlock.hide();this.remindBlock.hide()},getBlockClass:function(){return"form"},getLabel:function(){return this.getSetting("label")?this.getSetting("label"):
Yii.t("common","\u0424\u043e\u0440\u043c\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438")},isAutoContainer:function(){return!1},allowableChildTypes:function(){return"html header separator  userFormField button".split(" ")},getFormParams:function(a){var b=this.element.find(".active-state");0==b.length&&(b=this.element);var b=b.find(".xdget-formField"),c=this,d={};d.action=this.action;"auth"==this.action&&(d.password=this.loginBlock.passwordInput.val());"login"==this.getState()&&
(d.action="login");d.url=location.href;var e=!1;b.each(function(b,g){var k=$(g),l=k.data("xdget");l?(k=l.getFieldName(),a||l.validate()||e||(emptyField=Yii.t("common","\u041d\u0435 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u043f\u043e\u043b\u0435"),"undefined"!=typeof Yii&&(emptyField=Yii.t("common","Field is empty -")),c.showError(emptyField+" "+l.getFieldLabel()),e=!0),d[k]=l.getFieldValue()):k.find("input.append-handle-input")&&(l=k.find("input.append-handle-input"),l.is(":checkbox")&&
(d[l.attr("name")]=l.prop("checked")?1:0))});return e?!1:d},trySendData:function(a,b){if(this.trySendCallback&&!this.trySendCallback({state:this.getParam("state")}))return!1;var c=this,d=c.element.prop("action")?c.element.prop("action"):"",e={action:"processXdget"};e.xdgetId=this.xdgetId;c.getParam("metrika_submit_goal")&&window.yaCounter&&window.yaCounter.reachGoal(c.getParam("metrika_submit_goal"));e.params=a?a:this.getFormParams();c.clickedButton&&c.clickedButton.attr("name")&&(e.params.subaction=
c.clickedButton.attr("value"));if(!e.params)return!1;c.getParam("return_url")&&(e.params.returnUrl=c.getParam("return_url"));e.params.object_type=window.gcsObjectType;e.params.object_id=window.gcsObjectId;$(c.element).siblings(".form-result-block").remove();ajaxCall(d,e,{btn:c.clickedButton,enableSimpleSign:!0},function(a){if(a.redirectUrl){var d=a.redirectUrl;a.confirmMessage&&a.confirmCancelRedirectUrl&&!confirm(a.confirmMessage)&&(d=a.confirmCancelRedirectUrl);a.new_user_registered&&c.getParam("metrika_register_goal")&&
window.yaCounter&&window.yaCounter.reachGoal(c.getParam("metrika_register_goal"));c.getParam("metrika_finish_goal")&&window.yaCounter&&window.yaCounter.reachGoal(c.getParam("metrika_finish_goal"));"true"==d?$.gc.abstractXdget.prototype.redirectTo(window.location.origin+window.location.pathname):c.getParam("open_new_window")?window.top.location.href=d:0!=d.indexOf("#")?$.gc.abstractXdget.prototype.redirectTo(d):($.gc.abstractXdget.prototype.redirectTo(d),window.location.reload())}c.userForm&&a.needAuth&&
c.userForm(e,b).show();a.hasRegistered&&"login"!=c.getState()&&c.showLoginForm(a.email);a.errorMessage&&c.showError(a.errorMessage,a.disableButton);a.warning&&c.showWarning(a.warning);a.changeState&&c.changeState(a.changeState);b&&b(a)})},showError:function(a,b){this.showMessage(a,"danger",b)},showWarning:function(a){$('<div class="form-result-block error"><div class="error-message">'+a+"</div></div>").insertBefore(this.element)},showMessage:function(a,b,c){b||(b="success");(this.clickedButton?this.clickedButton:
this.element.find("button")).each(function(b,e){if(!$(e).hasClass("btn-error")){var f=$(e).html();$(e).html(a);$(e).addClass("btn-error");c?$(e).attr("disabled","disabled"):setTimeout(function(){$(e).html(f);$(e).removeClass("btn-error")},5E3)}})},createRemindBlock:function(){var a=this,b=$('<div class="remind-block">');$("<h2>"+Yii.t("common","Forgot password?")+"</h2>").appendTo(b);var c=$("<div class='form-group'></div>");$("<label>"+Yii.t("common","Email")+"</label>").appendTo(c);$emailInput=
$("<input type='text' class='form-control' placeholder='"+Yii.t("common","Please enter your email")+"'>");$emailInput.appendTo(c);b.emailInput=$emailInput;c.appendTo(b);c=$("<div class='form-group'></div>");$btnRemind=$('<button class="btn btn-primary">'+Yii.t("common","Send to mail")+"</button>");$btnRemind.appendTo(c);$remindResultEl=$("<span></span>");$remindResultEl.appendTo(c);$btnReturn=$('<button class="btn btn-link">'+Yii.t("common","Back")+"</button>");$btnReturn.appendTo(c);$emailInput.keyup(function(a){if(13==
a.keyCode)return $btnRemind.click(),!1});$btnReturn.click(function(){a.showMainForm();return!1});$btnRemind.click(function(){a.setClickedButton(this);a.trySendData({action:"remind",email:$emailInput.val()},function(b){b.error||($btnRemind.html(Yii.t("common","Resend")),a.showMessage(Yii.t("common","Password sent")))});return!1});c.appendTo(b);return b},createLoginBlock:function(){var a=$('<div class="login-block">');a.setEmail=function(b){a.find(".email-value").html(b)};var b=Yii.t("common","Email {email} has already been registered. To log in, enter your password, or receive it by email",
{email:"<span class='email-value'></span>"}),b=$("<div class='has-registered-message'><p>"+b+"</p></div>"),c=$("<div class='input-group form-group'></div>"),d=$("<input type='password' class='form-control'>");d.attr("placeholder",Yii.t("common","Enter password"));d.appendTo(c);$wrapper=$("<span class='input-group-btn'></span>");$("<button class='btn btn-success'><span class='glyphicon glyphicon-user'></span> "+Yii.t("common","Enter")+"</button>").appendTo($wrapper);$wrapper.appendTo(c);var e=$("<div class='form-group'></div>");
$remindResultEl=$("<span/>");var f=$("<a href='javascript:void(0)' class='restore-btn'></a>");f.html(Yii.t("common","Send me password on email {email}",{email:"<span class='email-value'></span>"}));$sepEl=$("<div class='user-form-sep'></div>");var g=$("<a href='javascript:void(0)' class='clearfix change-btn'></a>");g.text(Yii.t("common","Enter another email address"));$remindResultEl.appendTo(e);f.appendTo(e);$sepEl.appendTo(e);g.appendTo(e);var k=this;g.click(function(){k.showMainForm();return!1});
f.click(function(){k.action="remind";k.trySendData();k.action="auth";$remindResultEl.html(Yii.t("common","Password sent"));$(this).html(Yii.t("common","Resend"))});a.passwordInput=d;b.appendTo(a);c.appendTo(a);e.appendTo(a);return a},getOwnAvailableChildren:function(a){$.gc.xdget_form.prototype.getOwnAvailableChildren.call(this,a);a.email={group:"own",iconClass:"fa fa-at",type:"userFormField",label:Yii.t("common","\u042d\u043b. \u0430\u0434\u0440\u0435\u0441"),params:{fieldName:"email",fieldType:"string",
fieldOptions:{label:Yii.t("common","\u042d\u043b. \u0430\u0434\u0440\u0435\u0441"),placeholder:Yii.t("common","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0432\u043e\u0439 \u044d\u043b. \u0430\u0434\u0440\u0435\u0441")}}};a.firstName={group:"own",iconClass:"fa fa-user",type:"userFormField",label:Yii.t("common","\u0418\u043c\u044f"),params:{fieldName:"first_name",fieldType:"string",fieldOptions:{label:Yii.t("common","\u0418\u043c\u044f"),placeholder:Yii.t("common","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0432\u043e\u0435 \u0438\u043c\u044f")}}};
a.lastName={group:"own",iconClass:"fa fa-user",type:"userFormField",label:Yii.t("common","\u0424\u0430\u043c\u0438\u043b\u0438\u044f"),params:{fieldName:"last_name",fieldType:"string",fieldOptions:{label:Yii.t("common","\u0424\u0430\u043c\u0438\u043b\u0438\u044f"),placeholder:Yii.t("common","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0432\u043e\u044e \u0444\u0430\u043c\u0438\u043b\u0438\u044e")}}};a.fullName={group:"own",iconClass:"fa fa-user",type:"userFormField",label:Yii.t("common","\u0424\u0418\u041e"),
params:{fieldName:"full_name",fieldType:"string",fieldOptions:{label:Yii.t("common","\u0424\u0418\u041e"),placeholder:Yii.t("common","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0424\u0418\u041e")}}};a.phone={group:"own",iconClass:"fa fa-phone",type:"userFormField",label:Yii.t("common","\u0422\u0435\u043b\u0435\u0444\u043e\u043d"),params:{fieldName:"phone",fieldType:"phone",fieldOptions:{label:Yii.t("common","\u0422\u0435\u043b\u0435\u0444\u043e\u043d"),placeholder:Yii.t("common","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043b\u0435\u0444\u043e\u043d")}}};
this.getSetting("confirmAvailable")&&(a.phoneConfirm={group:"own",iconClass:"fa fa-check",type:"userFormField",label:Yii.t("common","\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430"),params:{fieldName:"phone_confirm_code",fieldType:"phone_confirm",fieldOptions:{label:Yii.t("common","\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430"),placeholder:Yii.t("common",
"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0434 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f, \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0439 \u0432 \u0441\u043c\u0441"),hide_filled:!0,captchaDisabled:this.getSetting("captchaDisabled")}}});a.country={group:"own",iconClass:"fa fa-globe",type:"userFormField",label:Yii.t("common","\u0421\u0442\u0440\u0430\u043d\u0430"),params:{fieldName:"country",fieldType:"string",fieldOptions:{label:Yii.t("common",
"\u0421\u0442\u0440\u0430\u043d\u0430"),placeholder:Yii.t("common","\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0441\u0432\u043e\u044e \u0441\u0442\u0440\u0430\u043d\u0443")}}};a.city={group:"own",iconClass:"fa fa-map-marker",type:"userFormField",label:Yii.t("common","\u0413\u043e\u0440\u043e\u0434"),params:{fieldName:"city",fieldType:"string",fieldOptions:{label:Yii.t("common","\u0413\u043e\u0440\u043e\u0434"),placeholder:Yii.t("common","\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0441\u0432\u043e\u0439 \u0433\u043e\u0440\u043e\u0434")}}};
a.profileImage={group:"own",iconClass:"fa fa-file-image-o",type:"userFormField",label:Yii.t("common","\u0410\u0432\u0430\u0442\u0430\u0440"),params:{fieldName:"profile_image",fieldType:"file",fieldOptions:{label:Yii.t("common","\u0410\u0432\u0430\u0442\u0430\u0440")}}};a.birthday={group:"own",iconClass:"fa fa-calendar",type:"userFormField",label:Yii.t("common","\u0414\u0430\u0442\u0430 \u0440\u043e\u0436\u0434\u0435\u043d\u0438\u044f"),params:{fieldName:"birthday",fieldType:"date",fieldOptions:{label:Yii.t("common",
"\u0414\u0430\u0442\u0430 \u0440\u043e\u0436\u0434\u0435\u043d\u0438\u044f"),placeholder:Yii.t("common","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0432\u043e\u044e \u0434\u0430\u0442\u0443 \u0440\u043e\u0436\u0434\u0435\u043d\u0438\u044f")}}};a.password={group:"own",iconClass:"fa fa-password",type:"userFormField",label:Yii.t("common","\u041f\u0430\u0440\u043e\u043b\u044c"),params:{fieldName:"password",fieldType:"password",fieldOptions:{label:Yii.t("common","\u041f\u0430\u0440\u043e\u043b\u044c"),
placeholder:Yii.t("common","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c")}}};a.comment={group:"own",iconClass:"fa fa-comment",type:"userFormField",label:Yii.t("common","\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439"),params:{fieldName:"comment",fieldType:"text",fieldOptions:{label:Yii.t("common","\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439"),placeholder:Yii.t("common","\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439 \u043a \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438")}}};
a.comment={group:"own",iconClass:window.isDisabledVK?"fa fa-facebook":"fa fa-vk",type:"socialUserFormField",label:Yii.t("common","\u041f\u0440\u0438\u0432\u044f\u0437\u043a\u0430 \u0441\u043e\u0446\u0441\u0435\u0442\u0435\u0439"),params:{fieldName:"",fieldType:"string"}};return a},useChildAvailableChildren:function(){return!0},getState:function(){return this.getParam("state")},createStateSelector:function(){this.selector&&(this.selector.detach(),this.selector=null);var a=this;this.selector=$selector=
$("<ul class='xdget-choose-state-selector'>");this.selector.prependTo(this.element);var b=this.getSetting("states"),c=this.getState(),d;for(d in b){var e=b[d];$option=$('<li class="state-link"/>');$option.data("state",d);$option.html(e);$option.appendTo($selector);c==d&&$option.addClass("active");$option.click(function(b){a.selector.find(".state-link").removeClass("active");$(this).addClass("active");b=$(this).data("state");a.changeState(b)})}return $selector}});
jQuery.widget("gc.xdget_userFormField",$.gc.xdget_formField,{allowableChildTypes:function(){if(this.parentXdget)return this.parentXdget.allowableChildTypes()}});
jQuery.widget("gc.xdget_socialUserFormField",$.gc.xdget_userFormField,{form:null,labelEl:null,buttonsEl:null,buttonLabels:{vk:"\u0412\u043a\u043e\u043d\u0442\u0430\u043a\u0442\u0435",facebook:"Facebook"},applyParams:function(a){a=this.getSetting("availableButtons");var b=this.getParam("button_type"),c=this.getParam("button_size");"lines"==this.getParam("buttons_layout")?this.element.addClass("buttons-on-new-line"):this.element.removeClass("buttons-on-new-line");if(!this.buttonsEl||this.appliedButtonType!=
b||this.appliedButtonSize!=c){this.element.empty();this.buttonsEl&&this.buttonsEl.detach();this.buttonsEl=$("<div>");this.buttonsEl.appendTo(this.element);this.form=this.element.parents(".xdget-common-user-form");this.labelEl=$("<span class='social-buttons-label'>");this.labelEl.appendTo(this.buttonsEl);var d=this.getSetting("isVkBotEnabled");for(key in a)"facebook"===key&&window.isDisabledFacebook||this.createButton(key,a[key],b,c,d).appendTo(this.buttonsEl);this.appliedButtonType=b;this.appliedButtonSize=
c;d&&(b=$("#vk-auth-btn").attr("href"),vkNativeApp.init({appLauncherElId:"vk-auth-btn",notSupportedMessage:"",universalLinkUrl:"https://vk.com",appUri:"vk:"+b+"&isMobileApp=1",androidAppId:"com.vkontakte.android",url:b+"&isMobileApp=0",mobileUrl:b+"&isMobileApp=1",debug:!1}))}b=0;for(key in a)b++;0<b&&this.getParam("label")&&0<this.getParam("label").length?(this.labelEl.html(this.getParam("label")),this.labelEl.removeClass("hidden")):(this.labelEl.addClass("hidden"),this.labelEl.empty())},getElementTitle:function(){return Yii.t("common",
"\u041f\u0440\u0438\u0432\u044f\u0437\u043a\u0430 \u0441\u043e\u0446\u0441\u0435\u0442\u0435\u0439")},createButton:function(a,b,c,d,e){linkedAuths=this.getParam("linked_auths");var f=this,g="btn-social-icon",k="";"buttons"==c&&(g="btn-social",k=b.label);"buttons"==c&&(g="btn-social",k=b.label);d&&0!=d.length&&(g+=" btn-"+d);linkedAuths&&linkedAuths[a]&&"buttons"==c&&(k=linkedAuths[a].name,linkedAuths[a].image_url&&0<linkedAuths[a].image_url.length&&(k="<img class='profile-auth-image' src='"+linkedAuths[a].image_url+
"'/>"+k));c=this.params.button_prefix?this.params.button_prefix:"";e&&"vk"==a?(b=$("<a id='vk-auth-btn' href='"+f.getSetting("vkLoginUrl")+"' class='btn btn-"+a+" "+g+"'><i class='"+b.icon+"'></i>"+c+k+"</a>"),b.click(function(){var a=$(this).attr("href");window.vkAuth.init([a])})):"chatium"==a?(e="/pl/chatium/control/app-link?path="+encodeURIComponent("screen/"+window.accountId+"/code-login/goto"),b=$("<a id='chatium-auth-btn' href='"+e+"' class='btn btn-"+a+" "+g+"'><img src='"+b.img+"'></a>"),
b.click(function(a){if(768>$(window).width())return!0;if(!window.accountUserWebSocketConnection)return alert("\u041d\u0435\u0442 \u043a\u043e\u043d\u043d\u0435\u043a\u0442\u0430 \u0441 \u0441\u043e\u043a\u0435\u0442\u043e\u043c. \u0421\u0435\u0439\u0447\u0430\u0441 \u044d\u0442\u043e\u0442 \u0432\u0438\u0434 \u0432\u0445\u043e\u0434\u0430 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d"),!1;f.element.parents(".xdget-common-user-form").xdget_userForm("changeState","login");$(".xdget-loginUserForm").addClass("for-chatium");
var b=$('<div class="chatium-login-form"/>'),c="\u0412\u043e\u0439\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 Chatium";"undefined"!=typeof Yii&&(c=Yii.t("common","\u0412\u043e\u0439\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 Chatium"));$("<h2>").addClass("xdget-header").html(c).appendTo(b);if(window.accountUserWebSocketConnection){var d=Math.ceil(1E7*Math.random());window.accountUserWebSocketConnection.subscribeChannel("chatiumLoginSocket"+d,function(a,b){ajaxCall("/pl/chatium/school/code-login",
{code:b.code,hash:b.hash},{},function(){$.gc.abstractXdget.prototype.redirectTo("/")})})}$('<img class="chatium-qr-code" src="/pl/chatium/control/app-link?qr=1&path='+encodeURIComponent("screen/"+window.accountId+"/code-login/"+d)+'">').appendTo(b);var e=$(".login-form .xdget-form-field-email");b.prependTo(e);$('<div class="chatium-instructions">'+Yii.t("common","\u041e\u0442\u0441\u043a\u0430\u043d\u0438\u0440\u0443\u0439\u0442\u0435 QR-\u043a\u043e\u0434 \u0441\u043a\u0430\u043d\u0435\u0440\u043e\u043c \u0438\u0437 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f Chatium \n \u0438\u043b\u0438 \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u044d\u043b. \u0430\u0434\u0440\u0435\u0441 \u0432 \u0444\u043e\u0440\u043c\u0435 \u043d\u0438\u0436\u0435")+
"</div>").appendTo(b);var k=$("<button type='button' class='btn btn-success' style='color: white'>\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441</button>"),g=$("<button type='button' class='btn btn-link btn-cancel' style='color: white'>\u041e\u0442\u043c\u0435\u043d\u0430</button>");g.insertAfter(e);k.insertAfter(e);k.click(function(){var a=e.find("input").val();ajaxCall("/pl/chatium/school/request-login",{email:a,code:d},{},function(){})});g.click(function(){b.detach();
g.detach();k.detach();$(".xdget-loginUserForm").removeClass("for-chatium")});a.preventDefault();a.stopPropagation();return!1})):(b=$("<button class='btn btn-"+a+" "+g+"'><i class='"+b.icon+"'></i>"+c+k+"</button>"),b.click(function(){if(f.form){var b=f.form.data("xdget"),c=b.getFormParams(!0);c.action="socialAuth";c.providerType=a;f.getParam("not_continue_process")&&(c.notContinueProcess=f.getParam("not_continue_process"));b.trySendData(c)}return!1}));return b},getFieldName:function(){return null},
getFieldValue:function(){return null},validate:function(){return!0}});
jQuery.widget("gc.xdget_offer",$.gc.abstractXdget,{offerId:null,offerContainerEl:null,offerData:null,applyParams:function(a){var b=this;$.gc.abstractXdget.prototype.applyParams.call(this,a);this.offerContainerEl=this.element.find(".offer-xdget-container");0==this.offerContainerEl.length&&(this.offerContainerEl=$('<div class="offer-xdget-container"></div>').appendTo(this.element));var c=this.getParentXdgetByType("offerSelector"),d="offerId[]";c&&(d="offerId_"+c.xdgetId+"[]");this.offerContainerEl.html('<label><input type="radio" class="offer-select-input" name='+
d+'> <div class="price-block"><span class="source-price"></span> <span class="offer-count-block"> <span class="unit-price offer-count-need-hide"></span> <span class="offer-count-need-hide">x</span> <input type="text" class="offer-count-input" size=6 value=1></span> <span class="final-price offer-count-need-hide"></span></div> <span class="offer-title offer-count-need-hide"></span> <div class="offer-desc-string offer-count-need-hide"></div>    </label></div>');this.isEditorEnabled()&&this.offerContainerEl.find(".offer-title").html("&lt;"+
Yii.t("common","\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u0435")+"&gt;");this.countEl=this.offerContainerEl.find(".offer-count-block");this.countInput=this.countEl.find("input");this.countInput.click(function(){b._setSelected(!0)});this.countInput.keyup(function(){b.changedCount()});c&&(this.offerContainerEl.data("offerId",this.getParam("offerId")),c.applyParams(a),d=this.element.find(".offer-select-input"),c.getParam("selectMany")?
d.attr("type","checkbox"):d.attr("type","radio"));this.countEl||(this.countEl=$(""),this.countEl.appendTo(this.offerContainerEl));this.getParam("showCount")?this.countEl.show():this.countEl.hide();this.getParam("defaultCount")&&this.countInput.val(this.getParam("defaultCount"));a&&this.element.click(function(){b._setSelected()});this.getParam("checkedByDefault")&&(this.element.find(".offer-select-input").prop("checked",!0),b._setSelected())},_setOfferData:function(a,b){this.offerId=a.id;var c=this.element.find(".offer-select-input");
b&&"checkbox"!=c.attr("type")?c.attr("type","checkbox"):b||"radio"==c.attr("type")||c.attr("type","radio");this.getParam("checkedByDefault")&&c.prop("checked",!0);"not_show"==a.access_type&&(this.element.addClass("access-not-show"),c.attr("disabled","disabled"),c.prop("checked",!1));"success"==a.access_type&&this.element.addClass("special-offer");"cant_buy"==a.access_type&&(this.element.addClass("access-cant-buy"),c.attr("disabled","disabled"),c.prop("checked",!1),""!=a.not_access_message&&$("<span class='not-access-message'>"+
a.not_access_message+"</span>").appendTo(this.element.find(".offer-title")));$offerEl=this.offerContainerEl;var d=this.getParam("title");d&&""!=d||(d=a.title);$offerEl.find(".offer-title").html(d);a.desc_string&&$offerEl.find(".offer-desc-string").html(a.desc_string);a.has_discount?$offerEl.find(".source-price").html(a.source_price_str):$offerEl.find(".source-price").empty();c.val(this.getParam("offerId"));c=[];if(0<a.otherCurrencies.length){c.push('<div class="currency-prices">');for(var d=[],e=
0;e<a.otherCurrencies.length;e++)d.push("<span>"+a.otherCurrencies[e]+"</span>");c.push(d.join(" "));c.push("</div>")}this.offerData=a;this.getParam("showCount")?($offerEl.find(".unit-price").html(a.final_price_str),this.changedCount()):(d=$offerEl.find(".final-price"),d.html(a.final_price_str),0==$offerEl.find(".other-currencies").length&&d.after('<div class="other-currencies">'),$offerEl.find(".other-currencies").html(c.join("")));$offerEl.appendTo(this.offerContainerEl)},changedCount:function(){var a=
this.countInput.val();(a*=1)||(a=1);$offerEl=this.offerContainerEl;$offerEl.find(".final-price").html(this.offerData.final_price*a+" "+this.offerData.currency_label)},_setSelected:function(a){this.element.parents(".xdget-offerSelector").find(".xdget-offer").removeClass("selected");a&&this.element.find(".offer-select-input").prop("checked",!0);this.element.find(".offer-select-input").prop("checked")&&this.element.addClass("selected")}});
jQuery.widget("gc.xdget_offerSelector",$.gc.xdget_container,{alreadyLoading:!1,currencySelectorInited:!1,productTable:null,offersModelsCache:{},applyParams:function(a){$.gc.xdget_container.prototype.applyParams.call(this,a);this.getParam("showDescString")?this.element.addClass("with-desc-string"):this.element.removeClass("with-desc-string");this.currency=this.params.currency;this.loadOffersData()},getLabel:function(){return Yii.t("common","\u0411\u043b\u043e\u043a \u0432\u044b\u0431\u043e\u0440\u0430 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u044f")},
isAutoContainer:function(){return!1},setOffersData:function(a,b,c){if("table"==this.getParam("viewMode"))this.productTable=this.makeProductTable(a,b,c);else{this.getChildBlocks().show();this.productTable&&(this.productTable.detach(),this.productTable=null);for(var d=0;d<a.length;d++){var e=a[d],f=c[e];f&&b[e]?($block=b[e],(e=$block.data("xdget"))&&e._setOfferData(f,this.getParam("selectMany"))):console.log("NOT FOUND BLOCK: "+e,b)}1==a.length?this.element.find(".offer-xdget-container input:checked").addClass("hidden"):
this.element.find(".offer-xdget-container input:checked").removeClass("hidden");"hidden"==this.getParam("viewMode")&&this.getChildBlocks().hide()}},loadOffersData:function(){var a=this,b=[],c={};this.element.find(".offer-xdget-container").each(function(a,d){var g=$(d).parents(".xdget-block"),k=$(d).data("offer-id");g&&(c[k]=g,b.push(k))});var d=b.join(",")+a.currency;0<b.length&&!a.alreadyLoading&&(a.offersModelsCache[d]?a.setOffersData(b,c,a.offersModelsCache[d]):(a.alreadyLoading=!0,ajaxCall("/sales/shop/offersData",
{ids:b,currency:a.currency,geoAreaId:window.geoAreaId},{},function(e){a.alreadyLoading=!1;a.offersModelsCache[d]=e.models;a.setOffersData(b,c,e.models)})))},makeProductTable:function(a,b,c){for(var d=this,e=[],f=0;f<a.length;f++)c[a[f]]&&"not_show"!=c[a[f]].access_type&&e.push(a[f]);a=e;e=this.element.find(".offer-selector-hor-table");0==e.length?(e=$("<table class='offer-selector-hor-table'/>"),e.appendTo(this.element),this.getChildBlocks().hide()):e.empty();4<a.length&&e.addClass("col-width-narrow");
e.addClass("col-total-"+a.length);var g=$("<tr><th class='product-title-td'>&nbsp;</th></tr>");g.appendTo(e);var k=[];if(productsOrder=this.getParam("productsOrder"))for(f=0;f<productsOrder.length;f++)k["p"+productsOrder[f]]={};for(f=0;f<a.length;f++){var l=a[f],n=c[l];if(n&&b[l]){$block=b[l];var h=$block.data("xdget");h&&h._setOfferData(n,d.getParam("selectMany"));var m="col"+f,m=m+(" offer-"+l);"success"==n.access_type&&(m+=" special-offer");c[a[f]].colClass=m;for(p in n.parts){var h=n.parts[p],
m=h.product_id,p="p"+m;k[p]&&k[p].id||(k[p]={product_id:m,id:m,title:h.product.title,description:h.product.description,parts:{}});k[p].parts[l]=h}}}$tbody=e;for(p in k)if(m=k[p],m.id){var q=$("<tr class='product-tr'/>");q.data("productId",m.id);h=$("<td class='product-title-td'/>");h.html(m.title);m.description&&$("<span class='description'>"+m.description+"</span>").appendTo(h);h.appendTo(q);q.appendTo($tbody);for(f=0;f<a.length;f++)l=a[f],n=c[l],h=$("<td class='offer-part-td offer-part-desc'/>"),
h.addClass(n.colClass),m.parts[l]?h.html(m.parts[l].description?m.parts[l].description:"<img src='/sales/img/v.png'>"):h.html("<img src='/sales/img/-.png'>"),h.appendTo(q)}$oldPriceTr=$("<tr class='source-price-tr'><td class='product-title-td'></td></tr>");$priceTr=$("<tr class='finish-price-tr'><td class='product-title-td'></td></tr>");$buttonTr=$("<tr class='button-tr'><td class='product-title-td'></td></tr>");p=!1;for(f=0;f<a.length;f++)if(l=a[f],n=c[l],m=n.colClass,h=$("<th/>"),h.addClass(m),
h.appendTo(g),n&&b[l]){k=n.title;b[l]&&b[l].data("xdget")&&b[l].data("xdget").getParam("title")&&(k=b[l].data("xdget").getParam("title"));h.html(k);h=$("<td class='offer-part-td'/>");h.addClass(m);h.appendTo($oldPriceTr);n.has_discount&&(h.html("<span class='source-price'>"+n.source_price_str+"</span>"),p=!0);h=$("<td class='offer-part-td'/>");h.addClass(m);h.appendTo($priceTr);k=["<span class='final-price'>"+n.final_price_str+"</span>"];if(0<n.otherCurrencies.length){k.push("<br />");for(var q=[],
r=0;r<n.otherCurrencies.length;r++)q.push(n.otherCurrencies[r]);k.push(q.join(", "))}h.html(k.join(""));h=$("<td class='offer-part-td'/>");h.addClass(m);(m=d.getParam("buyLabel"))&&""!=m||(m="\u0417\u0430\u043a\u0430\u0437\u0430\u0442\u044c");n.access_type&&""!=n.access_type&&"success"!=n.access_type?$("<span>"+n.not_access_message+"</span>").appendTo(h):($button=$("<button class='btn btn-order'>"+m+"</button>"),$button.appendTo(h),$button.data("offerId",l),$button.click(function(){var a=$(this).data("offerId");
d.selectOffer(a)}));h.appendTo($buttonTr)}p&&$oldPriceTr.appendTo(e);$priceTr.appendTo(e);$buttonTr.appendTo(e);return e},selectOffer:function(a){this.element.find(".xdget-offer").each(function(b,c){$block=$(c);var d=$block.data("xdget");d.offerId==a&&d._setSelected(!0)})},getAvailableChildren:function(a,b,c,d){a||(a={});a.offer={group:"own",iconClass:"fa fa-usd",type:"offer",label:Yii.t("common","\u041f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u0435")};$.gc.xdget_container.prototype.getAvailableChildren.call(this,
a,b,c);return a},initCurrencySelector:function(){if(!this.currencySelectorInited){this.currencySelectorInited=!0;var a=this;a.getParam("enableCurrencySelector")&&ajaxCall("/sales/shop/getAllCurrencies",{},{},function(b){for(var c=[],d=0;d<b.currencies.length;d++){var e=b.currencies[d],f="change-currency-btn";a.currency==e.code&&(f+=" active");c.push('<span class="'+f+'" data-code="'+e.code+'">'+e.name+"</span>")}a.element.prepend('<div class="currency-selector">'+("<div>\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0432\u0430\u043b\u044e\u0442\u0443: "+
c.join(", ")+"</div>")+"</div>");a.element.find(".change-currency-btn").click(function(){var b=$(this).data("code");a.currency!==b&&(a.element.find(".change-currency-btn").removeClass("active"),$(this).addClass("active"),a.currency=b,a.alreadyLoading=!1,a.loadOffersData())})})}}});
jQuery.widget("gc.xdget_orderForm",$.gc.xdget_userForm,{userForm:function(){var a;return function(b,c){var d=b.params,e=this;a||(a=window.gcUserFormModal({tab:"register",register:{skip_user_exists:!0,title:"\u041e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u043a\u0430\u0437\u0430",buttonTitle:"\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437",reload:!1,callback:function(a,b){b.email&&(d.email=b.email);e.trySendData(d,c)}}}));return a}}(),applyParams:function(a){$.gc.xdget_userForm.prototype.applyParams.call(this,
a)},getLabel:function(){return Yii.t("common","\u0424\u043e\u0440\u043c\u0430 \u0437\u0430\u043a\u0430\u0437\u0430")},isAutoContainer:function(){return!1},getPredefinedChildren:function(){var a=$.gc.xdget_userForm.prototype.getPredefinedChildren.call(this);a.push({group:"form",iconClass:"fa fa-at",type:"offerSelector",label:Yii.t("common","\u0412\u044b\u0431\u043e\u0440 \u043e\u0444\u0444\u0435\u0440\u0430"),params:{fieldOptions:{label:Yii.t("common","\u0412\u044b\u0431\u043e\u0440 \u043e\u0444\u0444\u0435\u0440\u0430")}}});
return a},getFormParams:function(a){var b=$.gc.xdget_userForm.prototype.getFormParams.call(this,a);if(!b)return null;var c=this.element.find("input.offer-select-input:checked");if(!a&&0==c.length)return this.showError(Yii.t("common","\u041d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u043e \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u0435")),null;b.offerId=[];b.offerCount={};c.each(function(){var a=$(this).val(),c=$(this).parents(".offer-xdget-container").find(".offer-count-input").val();
b.offerId.push(a);b.offerCount[a]=c});return b}});
jQuery.widget("gc.xdget_row",$.gc.xdget_container,{getBlockClass:function(){if(this.isFloatWidth())return"row"},enableEditor:function(){$.gc.xdget_container.prototype.enableEditor.call(this)},getSubcontainerType:function(){return"container"},applyParams:function(a){$.gc.xdget_container.prototype.applyParams.call(this,a);this.isFloatWidth()?(this.element.removeClass("row"),this.element.addClass("float-row")):(this.element.addClass("row"),this.element.removeClass("float-row"))},processDroppedBlock:function(a,
b,c){a=this.wrapDraggedBlock(a);switch(c){case "left":this.appendXdgetBlock(a,b,"before");break;case "right":this.appendXdgetBlock(a,b,"after");break;case "top":this.makeSubcontainer(a,b,"before");break;case "bottom":this.makeSubcontainer(a,b,"after");break;case "full":this.appendXdgetBlock(a)}return a},appendXdgetBlock:function(a,b,c){var d=a.data("xdget");d&&d.type==this.getSubcontainerType()?d=a:(d=xdgetRepository.createNewXdgetBlock(this.getSubcontainerType(),{},this),d.data("xdget").appendXdgetBlock(a),
b&&(b=b.getParentXdgetByType(this.getSubcontainerType())));$.gc.xdget_container.prototype.appendXdgetBlock.call(this,d,b,c)},isFloatWidth:function(){return this.getParam("float_width")},resizeChildren:function(){if(this.blocks){var a=12,b=[],c=this,d=0;if(this.isFloatWidth())this.blocks.each(function(a,b){var d=$(b);c.removeBlockSizeClass(d)});else{this.blocks.each(function(e,f){var g=$(f),h=g.data("xdget");h&&(h.columnNo=++d);h&&h.getMdWidth&&h.getMdWidth()?(h=h.getMdWidth(),a-=h,c.setBlockSize(g,
h)):b.push(g)});for(var e=0;e<b.length;e++){var f=b[e],g=Math.floor(a/b.length);1>g&&(g=1);this.setBlockSize(f,g)}}}},getLabel:function(){return this.blocks?"<"+this.blocks.length+" "+Yii.t("common","\u043a\u043e\u043b\u043e\u043d\u043a\u0438")+">":Yii.t("common","\u041a\u043e\u043b\u043e\u043d\u043a\u0438")},isRow:function(){return!0}});
jQuery.widget("gc.xdget_section",$.gc.xdget_container,{getBlockClass:function(){return"section"},getLabel:function(){return Yii.t("common","\u0421\u0435\u043a\u0446\u0438\u044f")},isAutoContainer:function(){return!1}});
jQuery.widget("gc.xdget_separator",$.gc.xdget_tag,{getTag:function(){return"hr"},getElementTitle:function(){var a="\u0420\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u044c";"undefined"!=typeof Yii&&(a=Yii.t("common","\u0420\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u044c"));return a}});jQuery.widget("gc.xdget_standard",$.gc.abstractXdget,{applyParams:function(a){this.options.existedXdget||this.element.html("<b>"+this.getLabel()+"</b>: "+Yii.t("common","\u043a\u043e\u043d\u0442\u0435\u043d\u0442 \u0432\u0438\u0434\u0436\u0435\u0442\u0430 \u043f\u043e\u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043f\u043e\u0441\u043b\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0438 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b"))}});
jQuery.widget("gc.xdget_surveyFieldsFormField",$.gc.xdget_formField,{renderedSurveyId:null,customFormEl:null,allowableChildTypes:function(){if(this.parentXdget)return this.parentXdget.allowableChildTypes()},getElementTitle:function(){return Yii.t("common","\u041f\u043e\u043b\u044f \u0430\u043d\u043a\u0435\u0442\u044b")},applyParams:function(a){$.gc.abstractXdget.prototype.applyParams.call(this,a);a=null;if(surveyFormXdget=this.getParentXdgetByType("surveyUserForm"))a=surveyFormXdget.getParam("survey_id");
this.renderedSurveyId==a&&this.customFormEl||this.loadSurvey(a)},build:function(){var a=this.getParentXdgetByType("surveyUserForm");if(a){var b=this;a.element.on("xdgetApplyParams",function(){b.applyParams(!1)})}},getFieldName:function(){return"surveyData"},getFieldValue:function(){return this.customFormEl.customForm("getFormValues")},validate:function(){return!0},loadSurvey:function(a){var b=this;b.customFormEl&&b.customFormEl.detach();b.customFormEl=$("<div>");b.customFormEl.appendTo(b.element);
a?ajaxCall("/user/surveyPublic/model/id/"+a,{},{},function(a){b.customFormEl.customForm({form:a.model.customForm})}):this.isEditorEnabled()&&b.customFormEl.html(Yii.t("common","\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0430\u043d\u043a\u0435\u0442\u0443 \u0432 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u0445 \u0444\u043e\u0440\u043c\u044b"));b.renderedSurveyId=a}});
jQuery.widget("gc.xdget_table",$.gc.abstractXdget,{options:{},children:[],childrenWidgets:[],table:null,slots:null,blocks:null,build:function(){for(var a in this.options.params.children){var b=this.options.params.children[a],c=b.xdget,d=c.jsName,e=$("<div/>");e[d]({params:c.params});b.el=e;this.children.push(b);this.element.find("a").click(function(){return!1})}},applyParams:function(a){if(a)this.table=this.contentEl.find("> table");else{this.table=$("<table/>");this.table.addClass("xdget-table-table");
for(a=0;a<this.params.rowsCount;a++){for(var b=$("<tr>"),c=0;c<this.params.colsCount;c++){var d=$("<td>");d.html(c+a);if(0==a&&0==c){var e=this.children[0];e.el.appendTo(d);e.el[e.xdget.jsName]("applyParams")}d.appendTo(b)}b.appendTo(this.table)}this.contentEl.empty();this.table.appendTo(this.contentEl)}$tds=this.table.find("> tbody > tr > td");$tds.css("width",Math.round(100/this.params.colsCount)+"%");this.slots=$tds;this.blocks=$tds.find("> .xdget-block")}});
jQuery.widget("gc.xdget_variant",$.gc.xdget_container,{getLabel:function(){return"\u0412\u0430\u0440\u0438\u0430\u043d\u0442"},isAutoContainer:function(){return!1},getElementTitle:function(){return this.getParam("title")?this.getParam("title"):"\u0412\u0430\u0440\u0438\u0430\u043d\u0442"}});
jQuery.widget("gc.xdget_video",$.gc.abstractXdget,{iframe:null,applyParams:function(a){(a=this.getParam("playerWidth"))&&""!=a||(a="550");var b=this.getParam("playerHeight");b||(b="100%"==a?"56%":.56*a);var c=this.getIframeUrl();c&&c&&(this.getParam("autoplay")&&!this.isEditorEnabled()&&(c+="autoplay=1"),this.iframe||(this.iframe=$("<iframe border=0 width='"+a+"' height='"+b+"' frameborder='0' allowfullscreen/>"),this.iframe.appendTo(this.element)),c!=this.iframe.attr("src")&&this.iframe.attr("src",
c));this.getParam("responsive")?(this.element.addClass("responsive"),$(this.iframe).css("width",""),$(this.iframe).css("height","")):(this.element.removeClass("responsive"),a&&this.isNumber(a)&&$(this.iframe).css("width",a+"px"),b&&this.isNumber(b)&&$(this.iframe).css("height",b+"px"))},getIframeUrl:function(){var a=this.getParam("videoId");if(!a)return null;var b=this.getParam("type","vimeo"),c="";"youtube"==b&&(c="//www.youtube.com/embed/"+a+"?");"vimeo"==b&&(c="//player.vimeo.com/video/"+a+"?title=0&amp;byline=0&amp;portrait=0&amp;color=c9ff23&");
return c}});window.modalWindows||(window.modalWindows={});
jQuery.widget("gc.xdget_modal",$.gc.xdget_div,{getLabel:function(){return"\u041c\u043e\u0434\u0430\u043b\u044c\u043d\u043e\u0435 \u043e\u043a\u043d\u043e"},applyParams:function(a){$.gc.xdget_container.prototype.applyParams.call(this,a);this.isEditorEnabled()?this.params.modal_width&&""!=this.params.modal_width&&this.params.modal_width!=this.appliedModalWidth?(this.element.width(this.params.modal_width),this.appliedModalWidth=this.params.modal_width):this.params.modal_width&&""!=this.params.modal_width||
!this.appliedModalWidth||this.element.width("auto"):this.params.elId&&(window.modalWindows[this.params.elId]=this)},getModalElement:function(){var a=$('<div class=\'modal gc-modal xdget-modal-main-el\'><div class=\'modal-dialog\'><div class=\'modal-content\'><div class=\'modal-body\'><div class="modal-xdget-content"><div class="link-close close-panel"><i class="fa fa-times"/></div></div></div></div></div><div class="link-close close-btn"><i class="fa fa-times"/></div></div>');768<$(window).width()?
(this.params.modal_width&&""!=this.params.modal_width&&a.find(".modal-dialog").width(this.params.modal_width),a.removeClass("for-mobile")):(a.addClass("for-mobile"),a.find(".modal-content").css("min-height",$(window).height()+"px"));a.find(".link-close").click(function(){a.modal("hide")});return a},show:function(){this.modalInitialized||(this.modalEl=this.getModalElement(),this.modalEl.modal({show:!1}),this.element.appendTo(this.modalEl.find(".modal-body")),this.modalInitialized=!0);this.modalEl.modal("show");
$(".modal-backdrop").addClass("for-modal-xdget")}});window.gcShowModal=function(a){window.modalWindows[a]&&(gcFixIncident("show-modal",a),window.modalWindows[a].show())};
jQuery.widget("gc.xdget_embed",$.gc.xdget_container,{getLabel:function(){return Yii.t("common","\u0412\u0438\u0434\u0436\u0435\u0442")},applyParams:function(a){$.gc.xdget_container.prototype.applyParams.call(this,a);this.params.css?(a=$("#css"+this.xdgetId),0<a.length?a.html(this.params.css):(a=$('<style id="css'+this.xdgetId+'">'),a.appendTo($("body"))),a.html(this.params.css)):$("#css"+this.xdgetId).detach()},canAddElement:function(){return!0},useChildAvailableChildren:function(){return!0}});
jQuery.widget("gc.xdget_insertEmbed",$.gc.xdget_area,{canBeInherited:!0,getLabel:function(){return this.getParam("model_name")?"\u0412\u0438\u0434\u0436\u0435\u0442: "+this.getParam("model_name"):"\u0412\u0438\u0434\u0436\u0435\u0442"},applyParams:function(a){$.gc.xdget_area.prototype.applyParams.call(this,a);this.params.css?(a=$("#css"+this.xdgetId),0<a.length?a.html(this.params.css):(a=$('<style id="css'+this.xdgetId+'">'),a.appendTo($("body"))),a.html(this.params.css)):$("#css"+this.xdgetId).detach()},
canAddElement:function(){return!0},useChildAvailableChildren:function(){return!1},isRootContainer:function(){return!1},isAutoContainer:function(){return!1},addBlockInside:function(){return!1}});
jQuery.widget("gc.xdget_page",$.gc.xdget_substitution,{getLabel:function(){var a="";"site"==this.params.type?(a="\u0428\u0430\u0431\u043b\u043e\u043d \u0441\u0430\u0439\u0442\u0430","undefined"!=typeof Yii&&(a=Yii.t("common","\u0428\u0430\u0431\u043b\u043e\u043d \u0441\u0430\u0439\u0442\u0430"))):(a="\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430","undefined"!=typeof Yii&&(a=Yii.t("common","\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430")));return a},applyParams:function(a){$.gc.xdget_substitution.prototype.applyParams.call(this,
a);this.applyCss();a=this.params.title?this.params.title:this.params.name;this.element.find(".page-title").html(a)},droppedBlock:function(a,b){var c=this.element.find(".area-PAGE").data("xdget");c||$.gc.xdget_substitution.prototype.droppedBlock.call(this,a,b);c.droppedBlock(a,b)},canAddElement:function(){return!0},useChildAvailableChildren:function(){return!0}});
jQuery.widget("gc.xdget_pageNavbar",$.gc.xdget_container,{build:function(){this.options.params.children=this.makeChildren();this.params=this.options.params;this.options.existedXdget=!1;this.options.params.elClass="container";this.element.empty();$.gc.xdget_container.prototype.build.call(this);this.element.find(".navbar-header > .xdget-container-self-content").addClass("navbar-brand")},makeChildren:function(){var a=window.rootXdget.options.params.pageRoot,b="navbar-header";this.options.params.pageId==
a.id&&(b+=" active");return[{type:"container",params:{uncontrolled:!0,children:[{type:"container",params:{uncontrolled:!0,elClass:b,content:a.title,link:a.url,children:[]}},{type:"container",params:{elClass:"collapse navbar-collapse navbar-responsive-collapse",children:[{type:"pageTree",params:{uncontrolled:!0,elClass:"navbar-nav nav",children:[],pageId:this.options.params.pageId}}]}}]}}]},createItem:function(a){var b={type:"item",params:{content:a.title,children:[]}};if(a.children){for(var c={type:"list",
params:{children:[]}},d=0;d<a.children.length;d++)c.params.children.push(this.createItem(a.children[d]));b.params.children.push(c)}return b},getElementTitle:function(){return"\u0412\u0435\u0440\u0445\u043d\u044f\u044f \u043d\u0430\u0432\u0438\u0433\u0430\u0446\u0438\u044f"}});
jQuery.widget("gc.xdget_pageTree",$.gc.xdget_list,{build:function(){this.options.params.children=this.makePageTreeChildren();this.params=this.options.params;this.options.existedXdget=!1;this.element.empty();$.gc.xdget_list.prototype.build.call(this);this.element.find(".dropdown a").addClass("dropdown-toggle");this.element.find(".dropdown a").data("toggle","dropdown");this.element.find(".dropdown-menu").addClass("sub-menu")},makePageTreeChildren:function(){var a=this.createItem(window.rootXdget.options.params.pageRoot);
return 0==a.params.children.length?[]:a.params.children[0].params.children},createItem:function(a){var b={type:"item",params:{uncontrolled:!0,content:a.title,link:a.url,children:[],elClass:""}};this.options.params.pageId==a.id&&(b.params.elClass="active");if(a.children){b.params.elClass+=" dropdown";for(var c={type:"list",params:{children:[],elClass:"dropdown-menu"}},d=0;d<a.children.length;d++)c.params.children.push(this.createItem(a.children[d]));b.params.children.push(c)}return b},getElementTitle:function(){return"\u0414\u0435\u0440\u0435\u0432\u043e \u0441\u0442\u0440\u0430\u043d\u0438\u0446"}});
jQuery.widget("gc.xdget_systemPage",$.gc.xdget_substitution,{getLabel:function(){var a="\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430";"undefined"!=typeof Yii&&(a=Yii.t("common","\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430"));return a},applyParams:function(a){$.gc.xdget_substitution.prototype.applyParams.call(this,a);a||(this.getParam("title")?$(".page-header h1").html(this.getParam("title")):$(".page-header h1").html(this.getParam("defaultTitle")))},isAutoContainer:function(){return!1}});
jQuery.widget("gc.xdget_webinarTranslation",$.gc.xdget_video,{messageEl:null,applyParams:function(a){var b=this;window.addEventListener("message",function(a){a.data instanceof Array&&(console.log(a.data),e(a.data));"tunnelLoaded"===a.data&&d()},!1);b.element.find(".controls .broadcasts").html("<tr><td>\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0439...</td></tr>");var c=b.element.find("iframe.tunnel");
b.element.find(".controls a.refresh").click(function(){d()});var d=function(){b.element.find(".controls .broadcasts").html("<tr><td>\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0439...</td></tr>");c.get(0).contentWindow.postMessage("getBroadcasts","*")},e=function(a){b.element.find(".controls .broadcasts").html("<tr><th>\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435</th><th>\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435</th><th>id</th><th></th></tr>");
0<a.length?($.each(a,function(a,c){$("<tr><td>"+c.snippet.title+"</td><td>"+c.snippet.description+"</td><td>"+c.id+'</td><td><button data-id="'+c.id+'" class="btn btn-success select-broadcast">\u0412\u044b\u0431\u0440\u0430\u0442\u044c</button></td></tr>').find(".select-broadcast").click(function(){b.element.find("input.broadcast-ytid").val($(this).attr("data-id"))}).end().appendTo(b.element.find(".controls .broadcasts"))}),1!==a.length||b.element.find("input.broadcast-ytid").val()||b.element.find("input.broadcast-ytid").val(a[0].id)):
b.element.find(".controls .broadcasts").html("<tr><td>\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0439...</td></tr>")};a=this.getIframeUrl();null==a?this.messageEl||(this.messageEl=$("<div class='alert alert-info'>"),this.messageEl.appendTo(this.element.find("div.video")),$("<h3 style='margin-bottom: 20px'>\u0422\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u044f \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430</h3>").appendTo(this.messageEl),
a=this.getParam("status"),this.getParam("can_start")?"new"==a?$("<div>\u041d\u0430\u0447\u043d\u0438\u0442\u0435 \u0435\u0451 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043a\u043d\u043e\u043f\u043a\u0438 '\u0412\u043e\u0439\u0442\u0438 \u0432 \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u044e'</div>").appendTo(this.messageEl):$("<div>\u0421\u0442\u0430\u0442\u0443\u0441 \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0438: "+this.getParam("status_label")+"</div>").appendTo(this.messageEl):
$("<div>\u041e\u0436\u0438\u0434\u0430\u0435\u043c \u043d\u0430\u0447\u0430\u043b\u0430 \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0438</div>")):this.messageEl&&(this.messageEl.detach(),this.messageEl=null);this.element.addClass("xdget-video");this.element.find("button.set-broadcast-ytid").click(function(a){a.preventDefault();a=b.element.find("input.broadcast-ytid").val();$.post("/pl/webinar/public/set-yt",{ytid:a,hurl:$(this).attr("data-hurl"),uid:$(this).attr("data-uid"),userid:$(this).attr("data-userid"),
hash:$(this).attr("data-hash")}).success(function(a){a.status&&"ok"===a.status&&document.location.reload()})});var f=this.getParam("playerWidth");f&&""!=f||(f="550");var g=this.getParam("playerHeight");g||(g="100%"==f?"56%":.56*f);(a=this.getIframeUrl())&&a&&(this.getParam("autoplay")&&!this.isEditorEnabled()&&(a+="autoplay=1"),this.iframe||(this.iframe=$("<iframe border=0 width='"+f+"' height='"+g+"' frameborder='0' allowfullscreen/>"),this.iframe.appendTo(this.element.find("div.video"))),a!=this.iframe.attr("src")&&
this.iframe.attr("src",a));this.getParam("responsive")?(this.element.addClass("responsive"),$(this.iframe).css("width",""),$(this.iframe).css("height","")):(this.element.removeClass("responsive"),f&&this.isNumber(f)&&$(this.iframe).css("width",f+"px"),g&&this.isNumber(g)&&$(this.iframe).css("height",g+"px"));$(".controls .broadcasts").length&&$(".main-page-block > .container > .xdget-root").prepend('<div style="color: red; position: relative; top: -30px;">\u0423\u0441\u0442\u0430\u0440\u0435\u0432\u0448\u0438\u0439 \u0442\u0438\u043f \u0432\u0435\u0431\u0438\u043d\u0430\u0440\u0430. \u0417\u0430\u043f\u0443\u0441\u043a \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u0435\u043d. \u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u043d\u043e\u0432\u044b\u0439 \u0432\u0435\u0431\u0438\u043d\u0430\u0440.</div>')},
getIframeUrl:function(){var a=this.getParam("ytid");a||(a=this.getParam("videoId"));return a?"https://www.youtube.com/embed/"+a+"?modestbranding=1&rel=0&showinfo=0&":null}});jQuery.widget("gc.xdget_lesson",$.gc.xdget_container,{options:{},getElementTitle:function(){return"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u0443\u0440\u043e\u043a\u0430"},build:function(){},applyParams:function(a){$.gc.xdget_container.prototype.applyParams.call(this,a);this.applyCss()}});
jQuery.widget("gc.xdget_lessonList",$.gc.xdget_standard,{options:{}});jQuery.widget("gc.xdget_training",$.gc.xdget_container,{options:{},getElementTitle:function(){return Yii.t("common","\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u0442\u0440\u0435\u043d\u0438\u043d\u0433\u0430")},build:function(){},applyParams:function(a){$.gc.xdget_container.prototype.applyParams.call(this,a);this.applyCss()}});jQuery.widget("gc.xdget_trainingList",$.gc.xdget_standard,{});
